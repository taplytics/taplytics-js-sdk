!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=23)}([function(e,t){function n(e){return void 0!==e&&r>=e}var r=0;t.LOUD=3,t.DEBUG=2,t.LOG=1,t.USER=0,t.setPriorityLevel=function(e){r=e},t.log=function(e,t,r){n(r)&&(console.log("[Taplytics]",e),t&&console.dir(t))},t.time=function(e,r,i,o){if(n(o)){if(i){e=e+", time: "+((new Date).getTime()-i.getTime())+"ms"}t.log(e,r,o)}},t.error=function(e,t,r){n(r)&&(console.error("[Taplytics]",e),t&&console.dir(t))}},function(e,t,n){function r(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}var i=n(7),o=n(42),s=n(0),a=n(3),u=n(45),c=n(5),l=n(46),f=n(47),p={cookieSessionID:"_tl_csid",deviceUUID:"_tl_duuid",sessionUUID:"_tl_suuid",sessionID:"_tl_sid",appUserID:"_tl_auid",cachedConfig:"_tl_config",sessionOptions:function(e,t){return e&&t?`tl_sopts_${e}_${t}`:null}};t.config=null,t.hasLoadedData=!1,t.sessionExpirationMin=30,t.start=function(e){return t.updateCookieSession().setDeviceUUID(e)},t.get=function(e,n){if(e){t.tick();var r=t.getCookieSessionID(),o=p.sessionOptions(r,e);if(o){if(!(n&&JSON&&JSON.parse))return i.get(o);var a=i.get(o);if(a&&"object"==typeof a)return a;try{return JSON.parse(a)}catch(t){return s.error("Session.get("+e+") failed to parse JSON.",t,s.DEBUG),a}}}},t.tick=function(){return t.updateCookieSession(),t},t.set=function(e,n,o){if(!e||void 0===n||0===(""+n).length)return!1;t.tick();var s=t.getCookieSessionID(),a=p.sessionOptions(s,e),u=r(new Date,"minute",t.sessionExpirationMin),c=n;return!!a&&(o&&JSON&&JSON.stringify&&(c=JSON.stringify(n)),i.set(a,c,{expires:u}),!0)},t.unset=function(e){if(!e)return!1;t.tick();var n=t.getCookieSessionID(),r=p.sessionOptions(n,e);i.expire(r)},t.updateCookieSession=function(){var e=t.getCookieSessionID();e||(e=o.v4(),t.deleteSessionID());var n=r(new Date,"minute",t.sessionExpirationMin);return i.set(p.cookieSessionID,e,{expires:n}),s.log("Set cookieSessionID to: "+e,{expires:n},s.LOUD),t},t.setDeviceUUID=function(e){return(e=e||t.getDeviceUUID())||(e=o.v4()),i.set(p.deviceUUID,e,{expires:new Date(2147483647e3)}),s.log("Set deviceUUID to: "+e,null,s.DEBUG),t},t.setSessionID=function(e){return i.set(p.sessionID,e),s.log("Set sessionID to: "+e,null,s.DEBUG),t},t.deleteSessionID=function(){return i.expire(p.sessionID),t},t.setAppUserID=function(e){return i.set(p.appUserID,e),s.log("Set appUserID to: "+e,null,s.DEBUG),t},t.deleteAppUserID=function(){return i.expire(p.appUserID),t},t.deleteSessionUUID=function(){i.expire(p.sessionUUID)},t.setCachedConfig=function(e){return i.setJSON(p.cachedConfig,{expVarsNamesHistory:e?e.expVarsNamesHistory:{},expVarsNames:e?e.expVarsNames:{},expVarsIds:e?e.expVarsIds:{},dynamicVars:e?e.dynamicVars:{}},null,!0),t},t.getDeviceUUID=function(){var e=i.get(p.sessionUUID);if(e)return e;var n=i.get(p.deviceUUID);return e===n&&t.deleteSessionUUID(),n},t.getCookieSessionID=function(){return i.get(p.cookieSessionID)},t.getAppUserID=function(){return i.get(p.appUserID)},t.getSessionID=function(){return i.get(p.sessionID)},t.getCachedConfig=function(){return i.getJSON(p.cachedConfig,!0)},t.getSessionAttributes=function(e){e=e||{};var t=c.toObject(),n=u();return e.sid=this.getSessionID(),e.ad=this.getDeviceUUID(),e.adt="browser",e.ct="browser",e.lv=a.isProduction()?"0":"1",e.sdk=a.obj().sdkVersion,e.rfr=n.referrer,e.exm=n.search.utm_medium,e.exs=n.search.utm_source,e.exc=n.search.utm_campaign,e.ext=n.search.utm_term,e.exct=n.search.utm_content,e.prms={search:n.search,location:t},navigator&&navigator.userAgent&&(e.prms.userAgent=navigator.userAgent),e},t.saveSessionConfig=function(e,n){n&&!e&&(s.log("Using cached config because of server error",null,s.DEBUG),e=t.getCachedConfig()),t.config=e,d=!0,e&&e.app_user_id&&e.session_id&&(t.hasLoadedData=!0,t.setAppUserID(e.app_user_id),t.setSessionID(e.session_id),t.tick()),e&&t.setCachedConfig(e),f.applyVisualEditsFromConfig(e),v.completePromises(!!e),(n||e&&e.app_user_id&&e.session_id)&&h.completePromises(!!e)};var h=new l({name:"sessionConfigPromises"});t.sessionConfigPromise=function(e){if(e)return t.hasLoadedData&&t.config?e(!0):void h.push(e)};var d=!1,v=new l({name:"configPromises"});t.configPromise=function(e){if(e)return d&&t.config?e(!0):void v.push(e)},t.resetSession=function(){t.deleteSessionID(),t.deleteAppUserID(),t.config=null,t.hasLoadedData=!1}},function(e,t,n){function r(e,t){return function(n,r){n&&l.error(`Error: ${e}`,n,l.DEBUG),t&&"function"==typeof t&&t(n,r),o()}}function i(e){return function(){h.enqueue({requestFunction:e,args:arguments}),d||o()}}function o(){if(!h.isEmpty()){d=!0;var e=h.dequeue();return l.log("Processing request",e,l.DEBUG),e&&e.requestFunction&&e.requestFunction.apply(t,e.args)}d=!1}function s(e,t){return("events"===e&&c.obj().eventsAPI?c.obj().eventsAPI:c.obj().baseAPI)+(e||"")+function(e){return e?`?${p.stringify(e)}`:""}(t)}function a(e,n){var r={},i={};return e&&"function"==typeof e?r=e():e&&(r=e),n&&"function"==typeof n?i=n():n&&(i=n),r.r_v="0",t.publicToken&&(r.public_token=t.publicToken),{query:r,payload:i}}var u=n(24),c=n(3),l=n(0),f=n(12),p=n(13),h=new f,d=!1;t.publicToken=null,t.setPublicToken=function(e){this.publicToken=e},t.get=i(function(e,n,i){var o=a(n),c=s(e);l.log(`GET request: ${c}`,o,l.LOUD),u.get(c).query(o.query).timeout(t.timeout).end(r(c,i))}),t.getJSON=i(function(e,n){var i=function(e){return c.obj().cdnAPI+(e||"")}(e);l.log(`GET JSON file request: ${i}`,null,l.LOUD),u.get(i).timeout(t.timeout).end(r(i,n))}),t.post=i(function(e,t,n,i){var o=a(t,n),c=s(e);l.log(`POST request: ${c}`,o,l.LOUD),u.post(c).query(o.query).set("Content-Type","application/json").send(o.payload).end(r(c,i))}),t.del=i(function(e,n,i,o){var c=a(n,i),f=s(e);l.log(`DELETE request: ${f}`,c,l.LOUD),u.del(f).query(c.query).set("Content-Type","application/json").timeout(t.timeout).send(c.payload).end(r(f,o))});t.timeout=4e3,t.setTimeout=function(e){var n=1e3*e;n>3e4?(l.error(`Timeout is larger then max timeout! timeout: ${e}s, max timeout: 30s. Using max timeout value.`,null,l.USER),t.timeout=3e4):n<1e3?(l.error(`Timeout is smaller then the min timeout! timeout: ${e}s, min timeout: 1s. Using min timeout value.`,null,l.USER),t.timeout=1e3):(l.log(`Set timeout: ${e}s`,null,l.LOUD),t.timeout=n)}},function(e,t,n){t.obj=function(){var e=n(6),t={cdnAPI:"https://cdn-config.taplytics.com/js/"};return"production"===e.env?(t.baseAPI="https://api.taplytics.com/public_api/v1/",t.eventsAPI="https://ping.taplytics.com/public_api/v1/"):"dev"===e.env||"development"===e.env?t.baseAPI="https://dev.taplytics.com/public_api/v1/":"stag"===e.env||"staging"===e.env?t.baseAPI="https://staging.taplytics.com/public_api/v1/":"local"===e.env&&(t.baseAPI="http://localhost:3002/public_api/v1/"),t.eventsFlushQueueTimeout=4e3,t.functionFlushQueueTimeout=500,t.sdkVersion="2.0.0",t.cookieDomain=e&&e.api&&e.api.config&&e.api.config.cookieDomain?e.api.config.cookieDomain:null,t},t.isProduction=function(){return"production"===n(6).env}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"isNumber",function(){return f}),n.d(t,"isString",function(){return p}),n.d(t,"debounce",function(){return h}),n.d(t,"isObjectLike",function(){return d});var r=n(8),i=n.n(r),o=n(32),s=n.n(o),a=n(34),u=n.n(a),c=n(35),l=n.n(c),f=u.a,p=s.a,h=l.a,d=i.a},function(e,t){function n(e){return r[e]?r[e]:"title"===e?document.title:document.location?document.location[e]:null}var r={};t.toObject=function(){return{href:n("href"),hash:n("hash"),search:n("search"),host:n("host"),protocol:n("protocol"),pathname:n("pathname"),title:n("title")}},t.attr=function(e){return n(e)},t.listen=function(e){}},function(e,t,n){var r={};r.api=n(10),r.init=n(52),r.isReady=n(53),r.identify=n(54),r.track=n(55),r.page=n(56),r.reset=n(57),r.propertiesLoaded=n(58),r.runningExperiments=n(59),r.variable=n(60),r.codeBlock=n(62),e.exports=r},function(e,t,n){function r(){return p||(p=new c,function(){if(p&&document.cookie&&document.cookie.length)for(var e=document.cookie.split(";"),t=0;t<e.length;t++)try{for(var n=e[t];" "===n.charAt(0);)n=n.substring(1);p.setCookies(n)}catch(e){o.error("Exception setting cookie",e,o.DEBUG)}}()),p}function i(){if(void 0!==h)return h;var e=!0;do{var t="gCStest="+Math.floor(1e8*Math.random());if(document.cookie=e?t+"expires=Tue, 01-Jan-2030 00:00:00 GMT":t,-1!==document.cookie.indexOf(t))return document.cookie=t+"expires=Sat, 01-Jan-2000 00:00:00 GMT",h=e,e}while(!(e=!e));return h=null,null}var o=n(0),s=n(4),a=n(3),u=n(41),c=n(9).CookieJar,l=n(9).Cookie,f=n(9).CookieAccessInfo;u.supported()||(o.log("Local Storage not supported",null,o.DEBUG),u=null),t.getJSON=function(e,n){var r=t.get(e,n);if(!r||!s.isString(r))return r;try{return JSON.parse(r)}catch(e){return o.error("JSON parse cookie value",e,o.DEBUG),null}},t.getLS=function(e){if(!u)return null;var t=u.get(e);return o.log("Got local storage key: "+e+" with value: "+t,null,o.LOUD),t},t.get=function(e,n){if(i()&&!n){var o=r(),s=new f(t.getCookieDomain()),a=o.getCookie(e,s);return a?a.value:void 0}return u?t.getLS(e):n?t.get(e):void 0},t.setJSON=function(e,n,r,i){var a=void 0;try{a=s.isString(n)?n:JSON.stringify(n)}catch(e){o.error("JSON stringify cookie value",e,o.DEBUG)}t.set(e,a,r,i)},t.set=function(e,n,s,a){if(e)if(i()&&!a){n=n||"",s=s||{};var c=r(),f=function(e,n,r){var i=new l(e+"="+n);return r&&(i.expiration_date=r),i.domain=t.getCookieDomain(),i}(e,n,s.expires).toString();document.cookie=f,c.setCookie(f),o.log("Setting cookies to:",f,o.LOUD)}else u?t.setLS(e,n,s):a&&t.set(e,n,s)},t.setLS=function(e,t,n){if(u){var r=n&&n.expires?30:null;u.set(e,t,r),o.log(`Setting local storage key: ${e} to value: ${t}`,null,o.LOUD)}},t.expire=function(e,n){i()&&!n?t.set(e,"-",{expires:new Date}):u?(o.log("Deleting local storage key: "+e,null,o.LOUD),u.remove(e)):n&&t.expire(e)};var p=void 0;t.getCookieDomain=function(){if(a.obj().cookieDomain)return a.obj().cookieDomain;var e=window.location.hostname,t=e?e.split(".").reverse():null;return t&&t.length>=3&&t[1].match(/^(com|edu|gov|net|mil|org|nom|co|ca|name|info|biz)$/i)?`.${t[2]}.${t[1]}.${t[0]}`:t&&t.length>1?`.${t[1]}.${t[0]}`:null};var h=void 0},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){!function(){"use strict";function e(t,n,r,i){return this instanceof e?(this.domain=t||void 0,this.path=n||"/",this.secure=!!r,this.script=!!i,this):new e(t,n,r,i)}function n(e,t,r){return e instanceof n?e:this instanceof n?(this.name=null,this.value=null,this.expiration_date=1/0,this.path=String(r||"/"),this.explicit_path=!1,this.domain=t||null,this.explicit_domain=!1,this.secure=!1,this.noscript=!1,e&&this.parse(e,t,r),this):new n(e,t,r)}function r(){var e,t,i;return this instanceof r?(e=Object.create(null),this.setCookie=function(r,o,s){var a,u;if(r=new n(r,o,s),a=r.expiration_date<=Date.now(),void 0!==e[r.name]){for(t=e[r.name],u=0;u<t.length;u+=1)if((i=t[u]).collidesWith(r))return a?(t.splice(u,1),0===t.length&&delete e[r.name],!1):(t[u]=r,r);return!a&&(t.push(r),r)}return!a&&(e[r.name]=[r],e[r.name])},this.getCookie=function(n,r){var i,o;if(t=e[n])for(o=0;o<t.length;o+=1)if((i=t[o]).expiration_date<=Date.now())0===t.length&&delete e[i.name];else if(i.matches(r))return i},this.getCookies=function(t){var n,r,i=[];for(n in e)(r=this.getCookie(n,t))&&i.push(r);return i.toString=function(){return i.join(":")},i.toValueString=function(){return i.map(function(e){return e.toValueString()}).join(";")},i},this):new r}e.All=Object.freeze(Object.create(null)),t.CookieAccessInfo=e,t.Cookie=n,n.prototype.toString=function(){var e=[this.name+"="+this.value];return this.expiration_date!==1/0&&e.push("expires="+new Date(this.expiration_date).toGMTString()),this.domain&&e.push("domain="+this.domain),this.path&&e.push("path="+this.path),this.secure&&e.push("secure"),this.noscript&&e.push("httponly"),e.join("; ")},n.prototype.toValueString=function(){return this.name+"="+this.value};var i=/[:](?=\s*[a-zA-Z0-9_\-]+\s*[=])/g;n.prototype.parse=function(e,t,r){if(this instanceof n){var i,o=e.split(";").filter(function(e){return!!e}),s=o[0].match(/([^=]+)=([\s\S]*)/),a=s[1],u=s[2];for(this.name=a,this.value=u,i=1;i<o.length;i+=1)switch(s=o[i].match(/([^=]+)(?:=([\s\S]*))?/),a=s[1].trim().toLowerCase(),u=s[2],a){case"httponly":this.noscript=!0;break;case"expires":this.expiration_date=u?Number(Date.parse(u)):1/0;break;case"path":this.path=u?u.trim():"",this.explicit_path=!0;break;case"domain":this.domain=u?u.trim():"",this.explicit_domain=!!this.domain;break;case"secure":this.secure=!0}return this.explicit_path||(this.path=r||"/"),this.explicit_domain||(this.domain=t),this}return(new n).parse(e,t,r)},n.prototype.matches=function(t){return t===e.All||!(this.noscript&&t.script||this.secure&&!t.secure||!this.collidesWith(t))},n.prototype.collidesWith=function(e){if(this.path&&!e.path||this.domain&&!e.domain)return!1;if(this.path&&0!==e.path.indexOf(this.path))return!1;if(this.explicit_path&&0!==e.path.indexOf(this.path))return!1;var t=e.domain&&e.domain.replace(/^[\.]/,""),n=this.domain&&this.domain.replace(/^[\.]/,"");if(n===t)return!0;if(n){if(!this.explicit_domain)return!1;var r=t.indexOf(n);return-1!==r&&r===t.length-n.length}return!0},t.CookieJar=r,r.prototype.setCookies=function(e,t,r){var o,s,a=[];for(e=(e=Array.isArray(e)?e:e.split(i)).map(function(e){return new n(e,t,r)}),o=0;o<e.length;o+=1)s=e[o],this.setCookie(s,t,r)&&a.push(s);return a}}()},function(e,t,n){t.request=n(2),t.users=n(16),t.events=n(21),t.config=n(51),t.init=function(e){return!!(e&&e._in&&e._in.token)&&!!this.request.setPublicToken(e._in.token)}},function(e,t,n){"use strict";e.exports=function(e){return null!==e&&"object"==typeof e}},function(e,t){e.exports=function(){var e=[];this.length=function(){return e.length},this.isEmpty=function(){return 0===e.length},this.enqueue=function(t){e.push(t)},this.enqueueAll=function(e){if(!e||e&&"array"!=typeof e)return 0;var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;this.enqueue(s)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e.length},this.dequeue=function(){if(0!==e.length)return e.shift()},this.flush=function(){var t=e.slice();return e=[],t},this.peek=function(){return e.length>0?e[0]:void 0}}},function(e,t,n){"use strict";var r=n(30),i=n(31),o=n(15);e.exports={formats:o,parse:i,stringify:r}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();t.arrayToObject=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},t.merge=function(e,n,i){if(!n)return e;if("object"!=typeof n){if(Array.isArray(e))e.push(n);else{if("object"!=typeof e)return[e,n];(i.plainObjects||i.allowPrototypes||!r.call(Object.prototype,n))&&(e[n]=!0)}return e}if("object"!=typeof e)return[e].concat(n);var o=e;return Array.isArray(e)&&!Array.isArray(n)&&(o=t.arrayToObject(e,i)),Array.isArray(e)&&Array.isArray(n)?(n.forEach(function(n,o){r.call(e,o)?e[o]&&"object"==typeof e[o]?e[o]=t.merge(e[o],n,i):e.push(n):e[o]=n}),e):Object.keys(n).reduce(function(e,o){var s=n[o];return r.call(e,o)?e[o]=t.merge(e[o],s,i):e[o]=s,e},o)},t.assign=function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",r=0;r<t.length;++r){var o=t.charCodeAt(r);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?n+=t.charAt(r):o<128?n+=i[o]:o<2048?n+=i[192|o>>6]+i[128|63&o]:o<55296||o>=57344?n+=i[224|o>>12]+i[128|o>>6&63]+i[128|63&o]:(r+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(r)),n+=i[240|o>>18]+i[128|o>>12&63]+i[128|o>>6&63]+i[128|63&o])}return n},t.compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var i=t[r],o=i.obj[i.prop],s=Object.keys(o),a=0;a<s.length;++a){var u=s[a],c=o[u];"object"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:o,prop:u}),n.push(c))}return function(e){for(var t;e.length;){var n=e.pop();if(t=n.obj[n.prop],Array.isArray(t)){for(var r=[],i=0;i<t.length;++i)void 0!==t[i]&&r.push(t[i]);n.obj[n.prop]=r}}return t}(t)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";var r=String.prototype.replace,i=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return r.call(e,i,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,n){var r=n(2),i=n(0),o=n(1);t.users_path="users",t.del=function(e){o.sessionConfigPromise(function(){var n=o.getAppUserID();if(n){var s={};s.sid=o.getSessionID(),s.ad=o.getDeviceUUID();var a={session:s};i.log("users_del",a,i.DEBUG),r.del(t.users_path+"/"+n,{},a,function(t,n){return t?i.error("Couldn't properly rest user.",n,i.DEBUG):i.log("Successfully reset the user.",n,i.DEBUG),e&&e(t,n)})}})},t.post=function(e,n,s){o.sessionConfigPromise(function(){var a=e,u=o.getSessionAttributes();a||(a={}),a.auid=o.getAppUserID();var c=new Date,l={session:u,app_user:a};i.log("users_post",JSON.stringify(l),i.DEBUG),r.post(t.users_path,{},l,function(e,t){if(e)i.error(n,e,i.USER);else{var r=t.body;r?(i.time("Users.post: successfully created/updated user.",t,c,i.DEBUG),o.setAppUserID(r.app_user_id),o.setSessionID(r.session_id),o.tick()):i.error(n,null,i.USER)}return s&&s(e,t)})})}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=n}).call(t,n(18))},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]}},function(e,t,n){function r(e,t){var n=new Date;return e.val=(n.getTime()-t.getTime())/1e3,y.enqueue(e)}function i(e){return{type:e,date:(new Date).toISOString(),tvKey:p.attr("title"),tvCl:p.attr("href"),prod:c.isProduction()?1:0,data:{_tl_view:p.toObject()}}}function o(){if(l.log("events.flushQueue: tick.",y,l.LOUD),y.isEmpty()||!d.hasLoadedData)return t.scheduleTick();var e=y.flush(),n=d.getSessionID(),r=v.getLS(g);r&&r.length&&(l.log(`Add ${r.length} events from local storage cache`,null,l.DEBUG),e=e.concat(r),v.expire(g,!0)),n||u.post({},"Taplytics::events.flushQueue: failed to create sessions. Events will fail to process."),this.post(e,function(n,r){n&&y.enqueueAll(e),t.scheduleTick()})}var s=this,a=n(2),u=n(16),c=n(3),l=n(0),f=n(50),p=n(5),h=n(12),d=n(1),v=n(7),y=new h,m={active:"appActive",terminate:"appTerminate",config:"tlClientConfig",fastConfig:"tlFastModeConfig",goal:"goalAchieved",pageView:"viewAppeared",pageClose:"viewDisappeared",timeOnPage:"viewTimeOnPage"};t.types=m,t.watchLifecycleEvents=function(){t.appActive();o.bind(s);window.addEventListener("unload",function(){l.log("Window on unload",null,l.DEBUG),t.appTerminate(),function(){if(!y.isEmpty()&&d.hasLoadedData){var e=y.flush();l.log(`save ${e.length} events to local storage`,y,l.DEBUG),v.setLS(g,e)}}()})},t.timeOnPage=function(e,t,n,r,o,s){var a=i(m.timeOnPage);if(s&&s.getTime){var u=(new Date).getTime(),c=s.getTime();a.val=(u-c)/1e3}return a.vKey=t,a.tKey=e,a.tvKey=r,a.tvCl=n,o&&(a.data=f(a.data||{},{_tl_view:o})),y.enqueue(a)},t.scheduleTick=function(){var e=o.bind(s);setTimeout(e,c.obj().eventsFlushQueueTimeout)},t.pageClose=function(e,t,n,r,o){var s=i(m.pageClose);return s.val=(new Date).toISOString(),s.vKey=t,s.tKey=e,s.tvKey=r,s.tvCl=n,o&&(s.data=f(s.data||{},{_tl_view:o})),y.enqueue(s)},t.pageView=function(e,t,n){var r=i(m.pageView);return n&&(r.data=f(r.data,n)),r.val=(new Date).toISOString(),r.vKey=t,r.tKey=e,y.enqueue(r)},t.goalAchieved=function(e,t,n){var r=i(m.goal);return n&&(r.data=f(r.data,n)),t&&(r.val=t),r.gn=e,y.enqueue(r)},t.appActive=function(){return y.enqueue(i(m.active))},t.appTerminate=function(){return y.enqueue(i(m.terminate))},t.clientConfig=function(e){if(e)return r(i(m.config),e)},t.fastModeConfig=function(e){if(e)return r(i(m.fastConfig),e)},t.post=function(e,t){var n=new Date;a.post("events",{},function(t){var n={};return n.sid=d.getSessionID(),{session:n,events:e}},function(e,r){return e?l.error("Taplytics::events.post: failed to log events",e,l.LOG):l.time("Taplytics::events.post: succesfully logged events.",r,n,l.DEBUG),t&&t(e,r)})};var g="_tl_eventsQueue"},function(e,t,n){var r=n(2),i=n(0);n(1);t.post=function(e,t){if(!e)return i.error("No new variable to post to server",null,i.DEBUG);var n=new Date,o={name:e.name,createdAt:new Date,variableType:e.defaultType,defaultVal:e.stringifyValue?e.stringifyValue(e.defaultValue):e.defaultValue};i.log("variable_post",o,i.DEBUG),r.post("variable",{},o,function(e,r){if(e)i.error("Failed to post variable",e,i.DEBUG);else{var o=r.body;o&&o.name&&i.time("Users.post: successfully created new variable.",o,n,i.DEBUG)}return t&&t(e)})}},function(e,t,n){var r=n(6),i=n(0),o=n(3);t.Taplytics=window.Taplytics=e.exports=r,t.flushAppQueue=function(){if(i.log("flushAppQueue tick",window._tlq,i.LOUD),window._tlq&&window._tlq instanceof Array){var e=window._tlq.slice();if(window._tlq=[],Array.prototype.sort&&e.sort(function(e,t){if(e instanceof Array&&t instanceof Array){if("init"===e[0]&&"identify"===t[0])return-1;if("identify"===e[0]&&"init"===t[0])return 1;if("init"===e[0]||"identify"===e[0])return-1}return 2}),e.length>0){i.log("flushAppQueue: "+e.length,e,i.LOUD);for(var n=0;n<e.length;n++){var s=e[n],a=s.shift(),u=s;if(r[a]&&r[a]instanceof Function)try{r[a].apply(r,u)}catch(e){i.error(`Attempted to call ${a}(${(u||[]).join(",")}); from the queue but failed!`,e,i.USER),e&&e.stack&&i.error(e.stack,null,i.DEBUG)}}}}setTimeout(t.flushAppQueue,o.obj().functionFlushQueueTimeout)},t.flushAppQueue()},function(e,t,n){function r(e){if(!h(e))return e;var t=[];for(var n in e)i(t,n,e[n]);return t.join("&")}function i(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){i(e,t,n)});else if(h(n))for(var r in n)i(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function o(e){for(var t,n,r={},i=e.split("&"),o=0,s=i.length;o<s;++o)-1==(n=(t=i[o]).indexOf("="))?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function s(e){return/[\/+]json\b/.test(e)}function a(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=function(e){for(var t,n,r,i,o=e.split(/\r?\n/),s={},a=0,u=o.length;a<u;++a)-1!==(t=(n=o[a]).indexOf(":"))&&(r=n.slice(0,t).toLowerCase(),i=m(n.slice(t+1)),s[r]=i);return s}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function u(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new a(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,n.xhr?(e.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,e.status=n.xhr.status?n.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),n.callback(e)}n.emit("response",t);var r;try{n._isResponseOK(t)||(r=new Error(t.statusText||"Unsuccessful HTTP response"))}catch(e){r=e}r?(r.original=e,r.response=t,r.status=t.status,n.callback(r,t)):n.callback(null,t)})}function c(e,t,n){var r=y("DELETE",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}var l;"undefined"!=typeof window?l=window:"undefined"!=typeof self?l=self:(console.warn("Using browser-only version of superagent in non-browser environment"),l=this);var f=n(25),p=n(26),h=n(11),d=n(27),v=n(29),y=t=e.exports=function(e,n){return"function"==typeof n?new t.Request("GET",e).end(n):1==arguments.length?new t.Request("GET",e):new t.Request(e,n)};t.Request=u,y.getXHR=function(){if(!(!l.XMLHttpRequest||l.location&&"file:"==l.location.protocol&&l.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")};var m="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};y.serializeObject=r,y.parseString=o,y.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},y.serialize={"application/x-www-form-urlencoded":r,"application/json":JSON.stringify},y.parse={"application/x-www-form-urlencoded":o,"application/json":JSON.parse},d(a.prototype),a.prototype._parseBody=function(e){var t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&s(this.type)&&(t=y.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},a.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=t,i.url=n,i},y.Response=a,f(u.prototype),p(u.prototype),u.prototype.type=function(e){return this.set("Content-Type",y.types[e]||e),this},u.prototype.accept=function(e){return this.set("Accept",y.types[e]||e),this},u.prototype.auth=function(e,t,n){1===arguments.length&&(t=""),"object"==typeof t&&null!==t&&(n=t,t=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});return this._auth(e,t,n,function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")})},u.prototype.query=function(e){return"string"!=typeof e&&(e=r(e)),e&&this._query.push(e),this},u.prototype.attach=function(e,t,n){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,n||t.name)}return this},u.prototype._getFormData=function(){return this._formData||(this._formData=new l.FormData),this._formData},u.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),n(e,t)},u.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},u.prototype.buffer=u.prototype.ca=u.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},u.prototype.pipe=u.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},u.prototype._isHost=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},u.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||function(){},this._finalizeQueryString(),this._end()},u.prototype._end=function(){var e=this,t=this.xhr=y.getXHR(),n=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==n){var r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var r=function(t,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=t,e.emit("progress",n)};if(this.hasListeners("progress"))try{t.onprogress=r.bind(null,"download"),t.upload&&(t.upload.onprogress=r.bind(null,"upload"))}catch(e){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof n&&!this._isHost(n)){var i=this._header["content-type"],o=this._serializer||y.serialize[i?i.split(";")[0]:""];!o&&s(i)&&(o=y.serialize["application/json"]),o&&(n=o(n))}for(var a in this.header)null!=this.header[a]&&this.header.hasOwnProperty(a)&&t.setRequestHeader(a,this.header[a]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send(void 0!==n?n:null),this},y.agent=function(){return new v},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){v.prototype[e.toLowerCase()]=function(t,n){var r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}),v.prototype.del=v.prototype.delete,y.get=function(e,t,n){var r=y("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=function(e,t,n){var r=y("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=function(e,t,n){var r=y("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=c,y.delete=c,y.patch=function(e,t,n){var r=y("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=function(e,t,n){var r=y("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=function(e,t,n){var r=y("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}var i=n(11);e.exports=r,r.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},r.prototype.parse=function(e){return this._parser=e,this},r.prototype.responseType=function(e){return this._responseType=e,this},r.prototype.serialize=function(e){return this._serializer=e,this},r.prototype.timeout=function(e){if(!e||"object"!=typeof e)return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}return this},r.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];r.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&t.status>=500&&501!=t.status)return!0;if(e){if(e.code&&~o.indexOf(e.code))return!0;if(e.timeout&&"ECONNABORTED"==e.code)return!0;if(e.crossDomain)return!0}return!1},r.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},r.prototype.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},r.prototype.catch=function(e){return this.then(void 0,e)},r.prototype.use=function(e){return e(this),this},r.prototype.ok=function(e){if("function"!=typeof e)throw Error("Callback required");return this._okCallback=e,this},r.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},r.prototype.get=function(e){return this._header[e.toLowerCase()]},r.prototype.getHeader=r.prototype.get,r.prototype.set=function(e,t){if(i(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},r.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},r.prototype.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),i(e)){for(var n in e)this.field(n,e[n]);return this}if(Array.isArray(t)){for(var r in t)this.field(e,t[r]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=""+t),this._getFormData().append(e,t),this},r.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},r.prototype._auth=function(e,t,n,r){switch(n.type){case"basic":this.set("Authorization","Basic "+r(e+":"+t));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e)}return this},r.prototype.withCredentials=function(e){return void 0==e&&(e=!0),this._withCredentials=e,this},r.prototype.redirects=function(e){return this._maxRedirects=e,this},r.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw TypeError("Invalid argument");return this._maxResponseSize=e,this},r.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},r.prototype.send=function(e){var t=i(e),n=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(t&&i(this._data))for(var r in e)this._data[r]=e[r];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)},r.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},r.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(t>=0){var n=this.url.substring(t+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,t)+"?"+n.join("&")}}},r.prototype._appendQueryString=function(){console.trace("Unsupported")},r.prototype._timeoutError=function(e,t,n){if(!this._aborted){var r=new Error(e+t+"ms exceeded");r.timeout=t,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},r.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},function(e,t,n){"use strict";function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}var i=n(28);e.exports=r,r.prototype.get=function(e){return this.header[e.toLowerCase()]},r.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=i.type(t);var n=i.params(t);for(var r in n)this[r]=n[r];this.links={};try{e.link&&(this.links=i.parseLinks(e.link))}catch(e){}},r.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e}},function(e,t,n){"use strict";t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})},t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */),r=n[0].slice(1,-1);return e[n[1].split(/ *= */)[1].slice(1,-1)]=r,e},{})},t.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},function(e,t){function n(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){n.prototype[e]=function(){return this._defaults.push({fn:e,arguments:arguments}),this}}),n.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},e.exports=n},function(e,t,n){"use strict";var r=n(14),i=n(15),o={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},s=Date.prototype.toISOString,a={delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,serializeDate:function(e){return s.call(e)},skipNulls:!1,strictNullHandling:!1};e.exports=function(e,t){var n=e,s=t?r.assign({},t):{};if(null!==s.encoder&&void 0!==s.encoder&&"function"!=typeof s.encoder)throw new TypeError("Encoder has to be a function.");var u=void 0===s.delimiter?a.delimiter:s.delimiter,c="boolean"==typeof s.strictNullHandling?s.strictNullHandling:a.strictNullHandling,l="boolean"==typeof s.skipNulls?s.skipNulls:a.skipNulls,f="boolean"==typeof s.encode?s.encode:a.encode,p="function"==typeof s.encoder?s.encoder:a.encoder,h="function"==typeof s.sort?s.sort:null,d=void 0!==s.allowDots&&s.allowDots,v="function"==typeof s.serializeDate?s.serializeDate:a.serializeDate,y="boolean"==typeof s.encodeValuesOnly?s.encodeValuesOnly:a.encodeValuesOnly;if(void 0===s.format)s.format=i.default;else if(!Object.prototype.hasOwnProperty.call(i.formatters,s.format))throw new TypeError("Unknown format option provided.");var m,g,_=i.formatters[s.format];"function"==typeof s.filter?n=(g=s.filter)("",n):Array.isArray(s.filter)&&(m=g=s.filter);var b=[];if("object"!=typeof n||null===n)return"";var w;w=s.arrayFormat in o?s.arrayFormat:"indices"in s?s.indices?"indices":"repeat":"indices";var D=o[w];m||(m=Object.keys(n)),h&&m.sort(h);for(var x=0;x<m.length;++x){var k=m[x];l&&null===n[k]||(b=b.concat(function e(t,n,i,o,s,u,c,l,f,p,h,d){var v=t;if("function"==typeof c)v=c(n,v);else if(v instanceof Date)v=p(v);else if(null===v){if(o)return u&&!d?u(n,a.encoder):n;v=""}if("string"==typeof v||"number"==typeof v||"boolean"==typeof v||r.isBuffer(v))return u?[h(d?n:u(n,a.encoder))+"="+h(u(v,a.encoder))]:[h(n)+"="+h(String(v))];var y=[];if(void 0===v)return y;var m;if(Array.isArray(c))m=c;else{var g=Object.keys(v);m=l?g.sort(l):g}for(var _=0;_<m.length;++_){var b=m[_];s&&null===v[b]||(y=Array.isArray(v)?y.concat(e(v[b],i(n,b),i,o,s,u,c,l,f,p,h,d)):y.concat(e(v[b],n+(f?"."+b:"["+b+"]"),i,o,s,u,c,l,f,p,h,d)))}return y}(n[k],k,D,c,l,f?p:null,g,h,d,v,_,y)))}var T=b.join(u),S=!0===s.addQueryPrefix?"?":"";return T.length>0?S+T:""}},function(e,t,n){"use strict";var r=n(14),i=Object.prototype.hasOwnProperty,o={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1};e.exports=function(e,t){var n=t?r.assign({},t):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:o.delimiter,n.depth="number"==typeof n.depth?n.depth:o.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:o.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:o.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:o.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:o.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:o.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:o.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:o.strictNullHandling,""===e||null===e||void 0===e)return n.plainObjects?Object.create(null):{};for(var s="string"==typeof e?function(e,t){for(var n={},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,a=r.split(t.delimiter,s),u=0;u<a.length;++u){var c,l,f=a[u],p=f.indexOf("]="),h=-1===p?f.indexOf("="):p+1;-1===h?(c=t.decoder(f,o.decoder),l=t.strictNullHandling?null:""):(c=t.decoder(f.slice(0,h),o.decoder),l=t.decoder(f.slice(h+1),o.decoder)),i.call(n,c)?n[c]=[].concat(n[c]).concat(l):n[c]=l}return n}(e,n):e,a=n.plainObjects?Object.create(null):{},u=Object.keys(s),c=0;c<u.length;++c){var l=u[c],f=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,s=/(\[[^[\]]*])/.exec(r),a=s?r.slice(0,s.index):r,u=[];if(a){if(!n.plainObjects&&i.call(Object.prototype,a)&&!n.allowPrototypes)return;u.push(a)}for(var c=0;null!==(s=o.exec(r))&&c<n.depth;){if(c+=1,!n.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(s[1])}return s&&u.push("["+r.slice(s.index)+"]"),function(e,t,n){for(var r=t,i=e.length-1;i>=0;--i){var o,s=e[i];if("[]"===s)o=(o=[]).concat(r);else{o=n.plainObjects?Object.create(null):{};var a="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,u=parseInt(a,10);!isNaN(u)&&s!==a&&String(u)===a&&u>=0&&n.parseArrays&&u<=n.arrayLimit?(o=[])[u]=r:o[a]=r}r=o}return r}(u,t,n)}}(l,s[l],n);a=r.merge(a,f,n)}return r.compact(a)}},function(e,t,n){var r=n(17),i=n(33),o=n(8),s="[object String]";e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&r(e)==s}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(17),i=n(8),o="[object Number]";e.exports=function(e){return"number"==typeof e||i(e)&&r(e)==o}},function(e,t,n){var r=n(36),i=n(37),o=n(40),s="Expected a function",a=Math.max,u=Math.min;e.exports=function(e,t,n){function c(t){var n=d,r=v;return d=v=void 0,b=t,m=e.apply(r,n)}function l(e){var n=e-_;return void 0===_||n>=t||n<0||D&&e-b>=y}function f(){var e=i();if(l(e))return p(e);g=setTimeout(f,function(e){var n=t-(e-_);return D?u(n,y-(e-b)):n}(e))}function p(e){return g=void 0,x&&d?c(e):(d=v=void 0,m)}function h(){var e=i(),n=l(e);if(d=arguments,v=this,_=e,n){if(void 0===g)return function(e){return b=e,g=setTimeout(f,t),w?c(e):m}(_);if(D)return g=setTimeout(f,t),c(_)}return void 0===g&&(g=setTimeout(f,t)),m}var d,v,y,m,g,_,b=0,w=!1,D=!1,x=!0;if("function"!=typeof e)throw new TypeError(s);return t=o(t)||0,r(n)&&(w=!!n.leading,y=(D="maxWait"in n)?a(o(n.maxWait)||0,t):y,x="trailing"in n?!!n.trailing:x),h.cancel=function(){void 0!==g&&clearTimeout(g),b=0,d=_=v=g=void 0},h.flush=function(){return void 0===g?m:p(i())},h}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){var r=n(38);e.exports=function(){return r.Date.now()}},function(e,t,n){var r=n(39),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,n(18))},function(e,t){e.exports=function(e){return e}},function(e,t){!function(t,n){void 0!==e&&e.exports?e.exports=n():t.lscache=n()}(this,function(){function e(){var e="__lscachetest__";if(void 0!==p)return p;try{if(!localStorage)return!1}catch(e){return!1}try{s(e,"__lscachetest__"),a(e),p=!0}catch(e){p=!(!t(e)||!localStorage.length)}return p}function t(e){return!!(e&&"QUOTA_EXCEEDED_ERR"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||"QuotaExceededError"===e.name)}function n(){return void 0===h&&(h=null!=window.JSON),h}function r(e){return e+v}function i(){return Math.floor((new Date).getTime()/m)}function o(e){return localStorage.getItem(d+_+e)}function s(e,t){localStorage.removeItem(d+_+e),localStorage.setItem(d+_+e,t)}function a(e){localStorage.removeItem(d+_+e)}function u(e){for(var t=new RegExp("^"+d+function(e){return e.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")}(_)+"(.*)"),n=localStorage.length-1;n>=0;--n){var i=localStorage.key(n);(i=(i=i&&i.match(t))&&i[1])&&i.indexOf(v)<0&&e(i,r(i))}}function c(e){var t=r(e);a(e),a(t)}function l(e){var t=r(e),n=o(t);if(n){var s=parseInt(n,y);if(i()>=s)return a(e),a(t),!0}}function f(e,t){b&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+e),t&&window.console.warn("lscache - The error was: "+t.message))}var p,h,d="lscache-",v="-cacheexpiration",y=10,m=6e4,g=Math.floor(864e13/m),_="",b=!1;return{set:function(l,p,h){if(e()){if("string"!=typeof p){if(!n())return;try{p=JSON.stringify(p)}catch(e){return}}try{s(l,p)}catch(e){if(!t(e))return void f("Could not add item with key '"+l+"'",e);var d,v=[];u(function(e,t){var n=o(t);n=n?parseInt(n,y):g,v.push({key:e,size:(o(e)||"").length,expiration:n})}),v.sort(function(e,t){return t.expiration-e.expiration});for(var m=(p||"").length;v.length&&m>0;)d=v.pop(),f("Cache is full, removing item with key '"+l+"'"),c(d.key),m-=d.size;try{s(l,p)}catch(e){return void f("Could not add item with key '"+l+"', perhaps it's too big?",e)}}h?s(r(l),(i()+h).toString(y)):a(r(l))}},get:function(t){if(!e())return null;if(l(t))return null;var r=o(t);if(!r||!n())return r;try{return JSON.parse(r)}catch(e){return r}},remove:function(t){e()&&c(t)},supported:function(){return e()},flush:function(){e()&&u(function(e){c(e)})},flushExpired:function(){e()&&u(function(e){l(e)})},setBucket:function(e){_=e},resetBucket:function(){_=""},enableWarnings:function(e){b=e}}})},function(e,t,n){var r=n(43),i=n(44),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){var r=n(19),i=n(20),o=r(),s=[1|o[0],o[1],o[2],o[3],o[4],o[5]],a=16383&(o[6]<<8|o[7]),u=0,c=0;e.exports=function(e,t,n){var r=t&&n||0,o=t||[],l=void 0!==(e=e||{}).clockseq?e.clockseq:a,f=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,h=f-u+(p-c)/1e4;if(h<0&&void 0===e.clockseq&&(l=l+1&16383),(h<0||f>u)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=f,c=p,a=l;var d=(1e4*(268435455&(f+=122192928e5))+p)%4294967296;o[r++]=d>>>24&255,o[r++]=d>>>16&255,o[r++]=d>>>8&255,o[r++]=255&d;var v=f/4294967296*1e4&268435455;o[r++]=v>>>8&255,o[r++]=255&v,o[r++]=v>>>24&15|16,o[r++]=v>>>16&255,o[r++]=l>>>8|128,o[r++]=255&l;for(var y=e.node||s,m=0;m<6;++m)o[r+m]=y[m];return t||i(o)}},function(e,t,n){var r=n(19),i=n(20);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t,n){var r=n(13);e.exports=function(){var e={},t=null;return location&&location.search&&location.search.length&&(e=r.parse(location.search.substr(1))),document&&document.referrer&&(t=document.referrer),{referrer:t,search:e}}},function(e,t,n){function r(e){this.promises=[],this.name=e?e.name:null}var i=n(0),o=n(2);r.prototype.push=function(e){function t(t){n||e&&(n=!0,e(t))}var n=!1,r=this;this.promises.push(t),setTimeout(function(){n||(i.log(r.name+" promise timed out",null,i.LOG),t())},o.timeout)},r.prototype.completePromises=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.promises[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;s&&s(e)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.promises=[]},e.exports=r},function(e,t,n){function r(){if("undefined"!=typeof MutationObserver&&!l&&document.body){o.log("start DOM Observer",null,o.DEBUG);var e=function(){o.log("DOM mutation observed",null,o.DEBUG),t.applyVisualEditsFromConfig(s.config)};(l=new MutationObserver(i.debounce(e,50,{leading:!0}))).observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!1,attributeFilter:[],characterDataOldValue:!1,attributeOldValue:!1}),e(),setTimeout(function(){o.log("Remove DOM observer",null,o.DEBUG),l.disconnect(),l=null},1e3*c)}}var i=n(4),o=n(0),s=n(1),a=n(48),u=n(49),c=8,l=void 0,f=setInterval(function(){document.body&&(r(),clearInterval(f),f=null)},1);t.applyVisualEditsFromConfig=function(e){if(e&&e.webModifications&&e.webElements){r(),o.log("Apply visual edits from config",null,o.DEBUG);var t=a.buildUrlFromLocation(window.location);e.webModifications.forEach(function(n){if(n){var r=e.webElements.find(function(e){return e._id===n._element});if(!r)return o.error(`No web element found for _id: ${n._element}, modification: ${n._id}`,null,o.DEBUG);a.matchUrlsByPath(r.url,t)&&u.applyModificationsToDOM({element:r,modification:n})}})}}},function(e,t){t.buildUrlFromLocation=function(e){return e&&e.origin?e.origin+(e.pathname?e.pathname:""):null},t.matchUrlsByPath=function(e,n){var r=t.getLocationFromUrl(e),i=t.getLocationFromUrl(n);return r&&i&&r.origin.length&&i.origin.length?t.buildUrlFromLocation(r)===t.buildUrlFromLocation(i):(e=e.replace(/^(http(s?):\/\/)?((www\.)?)/,""),n=n.replace(/^(http(s?):\/\/)?((www\.)?)/,""),e===n)},t.getLocationFromUrl=function(e){var t=document.createElement("a");return t.href=e,t.origin.length?{origin:t.origin,hostname:t.hostname,pathname:t.pathname,href:t.href}:null}},function(e,t,n){var r=n(0);t.applyModificationsToDOM=function(e){var n=e.element,i=e.modification;if(n&&i){var o=t.findElementsBySelector(n.selector),s=o&&o.length?o[0]:null;if(s){r.log(`Apply modification for web element: ${s._id}, modification: ${i._id}`,null,r.LOUD);var a=i.attributes.outerHTML;a&&s.outerHTML!==a&&(s.outerHTML=a)}}},t.findElementsBySelector=function(e){return document.querySelectorAll(e)}},function(e,t){e.exports=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}},function(e,t,n){function r(e){function t(e){if(e&&e.length){var t=!0,n=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value;a.isActive&&(f[a.name]?o.log("Warning dynamic variable is used in two experiments, name: "+a.name,null,o.LOG):f[a.name]=a)}}catch(e){n=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw r}}}}function n(e,n){"b"===n||"baseline"===n?(l[e.id]="b",i[e.name]="baseline",a[e.name]="baseline",t(e.baseline.dynamicVariables)):n&&(i[e.name]=n.name,a[e.name]=n.name,l[e.id]=n._id,t(n.dynamicVariables))}var r=s.getCachedConfig(),i=r&&r.expVarsNamesHistory&&r.expVarsNames||{},a={},c=r&&r.expVarsIds||{},l={},f={};if(e.experiments){var p=!0,h=!1,d=void 0;try{for(var v,y=e.experiments[Symbol.iterator]();!(p=(v=y.next()).done);p=!0){var m=v.value,g=function(e){if(!e||!e.winning_variation)return null;if("baseline"===e.winning_variation)return"b";var t=!0,n=!1,r=void 0;try{for(var i,o=e.variations[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;if(s&&e.winning_variation===s._id)return s}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return null}(m);if(g)n(m,g);else{if(i[m.name]||c[m.id]){var _=function(e,t){if(!t)return null;if("baseline"===t||"b"===t)return"b";var n=!0,r=!1,i=void 0;try{for(var o,s=e.variations[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;if(a&&(a._id===t||a.name===t))return a}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}(m,c[m.id]||i[m.name]);if(_){n(m,_);continue}}n(m,function(e){if(0===e.variations.length)return"baseline";var t=Math.random(),n=u.isNumber(e.baseline.distributionPercent)?e.baseline.distributionPercent:0;if(n&&t<n)return o.log("Show Baseline For Experiment: "+e._id,null,o.DEBUG),"baseline";var r=n,i=!0,s=!1,a=void 0;try{for(var c,l=e.variations[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;if(f.distributionPercent&&(r+=f.distributionPercent,t<r))return o.log(`Show Variation: ${f._id}, for experiment: ${e._id}`,null,o.DEBUG),f}}catch(e){s=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw a}}return o.error("Didn't find variation in experiment",null,o.DEBUG),"baseline"}(m))}}}catch(e){h=!0,d=e}finally{try{!p&&y.return&&y.return()}finally{if(h)throw d}}}if(e.variables){var b=!0,w=!1,D=void 0;try{for(var x,k=e.variables[Symbol.iterator]();!(b=(x=k.next()).done);b=!0){var T=x.value;f&&!f[T.name]&&(f[T.name]=T)}}catch(e){w=!0,D=e}finally{try{!b&&k.return&&k.return()}finally{if(w)throw D}}}return{expVarsNamesHistory:i,expVarsNames:a,cachedExpIds:c,expVarsIds:l,dynamicVars:f}}var i=n(2),o=n(0),s=n(1),a=n(21),u=n(4);t.fastMode=!1,t.startOptions=null,t.cookieDomain=null,t.get=function(e){var n=e.skipFastMode,r=e.dynamicConfig;if(r)return t.handleDynamicConfig(r);if(!n&&t.fastMode&&!s.test_experiments)return t.getFastModeConfig();var u=new Date,c=t.buildSessionParams();o.log("config_get",c,o.DEBUG),i.get("config",c,function(e,t){if(e)o.error("Failed to get config",e,o.DEBUG),s.saveSessionConfig(null,!0);else{var n=t.body;s.saveSessionConfig(n),n?(a.clientConfig(u),o.time("config.get: successfully got session config data",t,u,o.DEBUG)):o.error("No config data in response",null,o.DEBUG)}})},t.handleDynamicConfig=function(e){e&&(o.log("handle dynamic config",e,o.DEBUG),s.saveSessionConfig(e),t.postFastModeConfig())},t.buildSessionParams=function(){var e=s.getSessionAttributes();return e.auid=s.getAppUserID(),e.prms&&(e.prms=JSON.stringify(e.prms)),s.test_experiments&&(e.uev=JSON.stringify(s.test_experiments)),e},t.postFastModeConfig=function(){var e=new Date,n=t.buildSessionParams(),r=s.config;if(!r)return o.error("Missing config to POST",null,o.DEBUG);o.log("config_post",n,o.DEBUG),i.post("config",n,{expVarsIds:r.expVarsIds},function(t,n){if(t)o.error("Failed to post config",t,o.DEBUG),s.saveSessionConfig(r,!0);else{var i=n.body;i?(r.app_user_id=i.app_user_id,r.session_id=i.session_id,s.saveSessionConfig(r),a.clientConfig(e),o.time("config.post: successfully posted session config data",n,e,o.DEBUG)):(o.error("No config data in post response",null,o.DEBUG),s.saveSessionConfig(r,!0))}})},t.getFastModeConfig=function(){function e(){o.log("Skipping fast mode, get server config",null,o.DEBUG),t.get({skipFastMode:!0})}var n=new Date;o.log("get fastMode config",null,o.DEBUG),i.getJSON(i.publicToken+".json",function(t,i){if(!t&&i&&i.body){var u=r(i.body);u?(s.saveSessionConfig(u),o.time("config.get: successfully got fast mode config data",i,n,o.DEBUG),a.fastModeConfig(n),postFastModeConfig()):(o.error("No config data in fast mode response",null,o.DEBUG),e())}else o.error("Failed to get config",t,o.DEBUG),e()})},t.buildConfig=r},function(e,t,n){var r=n(0),i=(n(5),n(1)),o=n(7),s=n(4),a=!0;e.exports=function(e,t){if(function(e){return!(!e||"string"!=typeof e||!e.length)}(e)){this.env="production",t&&(this.api.config.startOptions=t,s.isNumber(t.log_level)&&r.setPriorityLevel(t.log_level),!1===t.auto_page_view&&(a=!1),t.env&&(this.env=t.env),t.test_experiments&&(i.test_experiments=t.test_experiments),t.fast_mode&&(this.api.config.fastMode=t.fast_mode),t.cookie_domain&&(this.api.config.cookieDomain=t.cookie_domain),s.isNumber(t.timeout)&&this.api.request.setTimeout(t.timeout)),this._in={},this._in.token=e,this._in.logger=r,this._in.cookies=o,this.api.init(this);var n=t&&t.config?t.config:void 0,u=n?n.ad:void 0;return i.start(u),this.api.config.get({dynamicConfig:n}),a&&this.page&&this.page(),this.api.events.scheduleTick(),this.api.events.watchLifecycleEvents(),this}r.error("An SDK token is required.",null,r.USER)}},function(e,t,n){n(10);e.exports=function(){return!(!this._in||!this._in.token)}},function(e,t,n){var r=n(0);e.exports=function(e){if(!this.isReady())return r.error("Taplytics::identify: you have to call Taplytics.init first.",null,r.USER),this;if(!function(e){return!(!e||e&&"object"!=typeof e)}(e))return r.error("Taplytics::identify: you have to pass in an object with user attributes.",null,r.USER),this;var t=function(e){var t={customData:{}},n=!0,r=!1,i=void 0;try{for(var o,s=Object.keys(e)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,u=e[a],c=function(e){var t={user_id:["user_id","id","userID","userId","customer_id","member_id"],email:["email","email_address"],name:["name"],firstName:["first_name","firstName"],lastName:["last_name","lastName"],avatarUrl:["avatar","avatarUrl","avatar_url"],age:["age"],gender:["gender"]},n=!0,r=!1,i=void 0;try{for(var o,s=Object.keys(t)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value,u=t[a];if(u){var c=!0,l=!1,f=void 0;try{for(var p,h=u[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var d=p.value;if(d&&e&&d===e)return{isTopLevel:!0,acceptedKey:d}}}catch(e){l=!0,f=e}finally{try{!c&&h.return&&h.return()}finally{if(l)throw f}}}}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return{isTopLevel:!1}}(a);c&&c.isTopLevel?t[c.acceptedKey]=u:t.customData[a]=u}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return t}(e);return this.api.users.post(t,"Taplytics::identify: failed to save the user attributes properly."),this}},function(e,t,n){var r=n(0),i=n(1),o=n(4);e.exports=function(e,t,n){if(!this.isReady())return r.error("track: you have to call Taplytics.init first.",null,r.USER),!1;if(!e)return r.error("track: you have to specify an event name.",null,r.USER),!1;var s=t,a=n;return o.isObjectLike(t)&&!n&&(s=void 0,a=t),s&&!o.isNumber(s)?(r.error("track: if you're passing a value, it has to be a number.",null,r.USER),!1):(i.tick(),this.api.events.goalAchieved(e,s,a),this)}},function(e,t,n){var r=n(0),i=n(5),o=n(1),s={previous_page_href:"p_p_l_h",previous_page_title:"p_p_l_t",previous_page_location:"p_p_l",previous_page_name:"p_p_n",previous_page_category:"p_p_c",previous_page_view_date:"p_p_v_d"};e.exports=function(e,t,n){if(!this.isReady())return r.error("track: you have to call Taplytics.init first.",null,r.USER),this;var a=e,u=t,c=n;if("object"!=typeof t||n?e&&!t&&(a=void 0,u=e):(a=void 0,u=e,c=t),o.tick(),o.get(s.previous_page_href)){var l=function(){var e=o.get(s.previous_page_view_date);return e&&(e=new Date(e)),{category:o.get(s.previous_page_category),name:o.get(s.previous_page_name),href:o.get(s.previous_page_href),title:o.get(s.previous_page_title),location:o.get(s.previous_page_location,JSON&&JSON.parse),view_date:e}}();this.api.events.pageClose(l.category,l.name,l.href,l.title,l.location),this.api.events.timeOnPage(l.category,l.name,l.href,l.title,l.location,l.view_date),o.unset(s.previous_page_category),o.unset(s.previous_page_name),o.unset(s.previous_page_href),o.unset(s.previous_page_title),o.unset(s.previous_page_location),o.unset(s.previous_page_view_date)}return this.api.events.pageView(a,u,c),function(e,t){o.set(s.previous_page_category,e),o.set(s.previous_page_name,t),o.set(s.previous_page_href,i.attr("href")),o.set(s.previous_page_title,i.attr("title")),o.set(s.previous_page_location,i.toObject(),JSON&&JSON.stringify),o.set(s.previous_page_view_date,(new Date).toISOString())}(a,u),this}},function(e,t,n){var r=n(0),i=n(1);e.exports=function(){return this.isReady()?(i.tick(),this.api.users.del(),i.resetSession(),this.api.config.get({}),this):(r.error("Taplytics::reset: you have to call Taplytics.init first.",null,r.USER),!1)}},function(e,t,n){var r=n(1);e.exports=function(e){r.configPromise(e)}},function(e,t,n){var r=n(1);e.exports=function(e){r.configPromise(function(){var t=r.config&&r.config.expVarsNames?r.config.expVarsNames:{};return e&&e(t)})}},function(e,t,n){n(1);var r=n(61);e.exports=function(e,t,n){var i=new r(e,t,n);return i&&i.init?i:null}},function(e,t,n){function r(e,t,n){return this.init=!1,e?(this.name=e,this.defaultValue=t,this.value=t,this.updatedBlock=n,this.defaultType=this.getValueType(t),this.defaultType?(this.init=!0,void this.getValueFromConfig()):i.log("Error: Taplytics variables only support Strings, Numbers, and Booleans.",null,i.USER)):i.log("Error: Taplytics variable is missing a name",null,i.USER)}var i=n(0),o=n(1),s=n(22);r.prototype.getValueType=function(e){return"string"==typeof e?"String":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"object"==typeof e?"JSON":null},r.prototype.stringifyValue=function(e){return"JSON"===this.defaultType?JSON.stringify(e):e},r.prototype.parseValue=function(e){if("JSON"===this.defaultType){if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){i.log("Error parsing JSON variable",e,i.LOG)}return null}return e},r.prototype.getValueFromConfig=function(){function e(){t.updatedBlock&&t.updatedBlock(t.value)}var t=this;o.configPromise(function(){var n=o.config,r=n&&n.dynamicVars?n.dynamicVars[t.name]:null;if(r){if(r.variableType!==t.defaultType)return e(),i.error("Taplytics variable "+t.name+" default type does not match server: "+r.variableType,null,i.LOG);t.value=t.parseValue(r.value)}else n&&(i.log("New Taplytics Variable: "+t.name,null,i.DEBUG),s.post(t));e()})},e.exports=r},function(e,t,n){var r=n(0),i=n(1),o=n(22);e.exports=function(e,t){if(!e)return r.error("No name to run code block",null,r.USER);i.configPromise(function(){var n=i.config;if(n){var s=n.dynamicVars?n.dynamicVars[e]:null;if(s){if("Code Block"!==s.variableType)return r.error("Taplytics code block "+e+" default type does not match server: "+s.variableType,null,r.LOG);t&&s.value&&t()}else r.log("New Taplytics Code Block: "+e,null,r.DEBUG),o.post({name:e,defaultType:"Code Block",defaultValue:!1})}})}}]);
//# sourceMappingURL=taplytics.min.js.map