!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){var i=t[s][1][e];return r(i?i:e)},l,l.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){i.request=e("./api/base"),i.users=e("./api/users"),i.events=e("./api/events"),i.config=e("./api/config"),i.init=function(e){return!!(e&&e._in&&e._in.token)&&this.request.setPublicToken(e._in.token)}},{"./api/base":2,"./api/config":3,"./api/events":4,"./api/users":5}],2:[function(e,t,i){function n(e,t,i){var n=d(t),r=p(e);m.log("GET request: "+r,n,m.LOUD),g.get(r).query(n.query).timeout(k).end(u(r,i))}function r(e,t){var i=f(e);m.log("GET JSON file request: "+i,null,m.LOUD),g.get(i).timeout(k).end(u(i,t))}function o(e,t,i,n){var r=d(t,i),o=p(e);m.log("POST request: "+o,r,m.LOUD),g.post(o).query(r.query).set("Content-Type","application/json").send(r.payload).end(u(o,n))}function s(e,t,i,n){var r=d(t,i),o=p(e);m.log("DELETE request: "+o,r,m.LOUD),g.del(o).query(r.query).set("Content-Type","application/json").timeout(k).send(r.payload).end(u(o,n))}function a(e){this.publicToken=e}function u(e,t){return function(i,n){i&&m.error("Error: "+e,i,m.DEBUG),t&&"function"==typeof t&&t(i,n),l()}}function c(e){return function(){_.enqueue({requestFunction:e,args:arguments}),w||l()}}function l(){if(!_.isEmpty()){w=!0;var e=_.dequeue();return m.log("Processing request",e,m.DEBUG),e&&e.requestFunction&&e.requestFunction.apply(i,e.args)}w=!1}function p(e,t){var i="events"===e&&v.obj().eventsAPI?v.obj().eventsAPI:v.obj().baseAPI;return i+(e||"")+h(t)}function f(e){return v.obj().cdnAPI+(e||"")}function h(e){return e?"?"+b.stringify(e):""}function d(e,t){var n={},r={};return e&&"function"==typeof e?n=e():e&&(n=e),t&&"function"==typeof t?r=t():t&&(r=t),n.r_v="0",i.publicToken&&(n.public_token=i.publicToken),{query:n,payload:r}}var g=e("superagent"),v=e("../../config"),m=e("../lib/logger"),y=e("../lib/queue"),b=e("qs"),_=new y,w=!1;i.publicToken=null,i.setPublicToken=a,i.get=c(n),i.getJSON=c(r),i.post=c(o),i.del=c(s);var D=1e3,x=3e4,k=4e3;i.setTimeout=function(e){var t=1e3*e;t>x?(m.error("Timeout is larger then max timeout! timeout: "+e+"s, max timeout: "+x/1e3+"s. Using max timeout value.",null,m.USER),k=x):t<D?(m.error("Timeout is smaller then the min timeout! timeout: "+e+"s, min timeout: "+D/1e3+"s. Using min timeout value.",null,m.USER),k=D):(m.log("Set timeout: "+e+"s",null,m.LOUD),k=t)}},{"../../config":28,"../lib/logger":20,"../lib/queue":22,qs:33,superagent:38}],3:[function(e,t,i){function n(){var e=p.getSessionAttributes();return e.auid=p.getAppUserID(),e.prms&&(e.prms=JSON.stringify(e.prms)),p.test_experiments&&(e.uev=JSON.stringify(p.test_experiments)),e}function r(){var e=new Date,t=n(),i=p.config;return i?(l.log("config_post",t,l.DEBUG),void c.post("config",t,i,function(t,n){if(t)l.error("Failed to post config",t,l.DEBUG),p.saveSessionConfig(i,!0);else{var r=n.body;r?(i.app_user_id=r.app_user_id,i.session_id=r.session_id,p.saveSessionConfig(i),f.clientConfig(e),l.time("config.post: successfully posted session config data",n,e,l.DEBUG)):(l.error("No config data in post response",null,l.DEBUG),p.saveSessionConfig(i,!0))}})):l.error("Missing config to POST",null,l.DEBUG)}function o(){function e(){l.log("Skipping fast mode, get server config",null,l.DEBUG),i.get(!0)}var t=new Date;l.log("get fastMode config",null,l.DEBUG),c.getJSON(c.publicToken+".json",function(i,n){if(!i&&n&&n.body){var o=s(n.body);o?(p.saveSessionConfig(o),l.time("config.get: successfully got fast mode config data",n,t,l.DEBUG),f.fastModeConfig(t),r()):(l.error("No config data in fast mode response",null,l.DEBUG),e())}else l.error("Failed to get config",i,l.DEBUG),e()})}function s(e){function t(e){if(e&&e.length)for(var t=0;t<e.length;t++){var i=e[t];i.isActive&&(h[i.name]?l.log("Warning dynamic variable is used in two experiments, name: "+i.name,null,l.LOG):h[i.name]=i)}}function i(e,i){"b"===i||"baseline"===i?(f[e.id]="b",o[e.name]="baseline",s[e.name]="baseline",t(e.baseline.dynamicVariables)):i&&(o[e.name]=i.name,s[e.name]=i.name,f[e.id]=i._id,t(i.dynamicVariables))}function n(e,t){if(!t)return null;if("baseline"===t||"b"===t)return"b";for(var i=0;i<e.variations.length;i++){var n=e.variations[i];if(n&&(n._id===t||n.name===t))return n}}var r=p.getCachedConfig(),o=r&&r.expVarsNamesHistory&&r.expVarsNames||{},s={},c=r&&r.expVarsIds||{},f={},h={};if(e.experiments)for(var d=0;d<e.experiments.length;d++){var g=e.experiments[d],v=a(g);if(v)i(g,v);else{if(o[g.name]||c[g.id]){var m=c[g.id]||o[g.name],y=n(g,m);if(y){i(g,y);continue}}i(g,u(g))}}if(e.variables)for(var d=0;d<e.variables.length;d++){var b=e.variables[d];h&&!h[b.name]&&(h[b.name]=b)}return{expVarsNamesHistory:o,expVarsNames:s,cachedExpIds:c,expVarsIds:f,dynamicVars:h}}function a(e){if(!e||!e.winning_variation)return null;if("baseline"===e.winning_variation)return"b";for(var t=0;t<e.variations.length;t++){var i=e.variations[t];if(i&&e.winning_variation===i._id)return i}return null}function u(e){if(0===e.variations.length)return"baseline";var t=Math.random(),i=h.isNumber(e.baseline.distributionPercent)?e.baseline.distributionPercent:0;if(i&&t<i)return l.log("Show Baseline For Experiment: "+e._id,null,l.DEBUG),"baseline";for(var n=i,r=0;r<e.variations.length;r++){var o=e.variations[r];if(o.distributionPercent&&(n+=o.distributionPercent,t<n))return l.log("Show Variation: "+o._id+", for experiment: "+e._id,null,l.DEBUG),o}return l.error("Didn't find variation in experiment",null,l.DEBUG),"baseline"}var c=e("./base"),l=e("../lib/logger"),p=e("../lib/session"),f=e("./events"),h=e("../lib/tools");i.fastMode=!1,i.startOptions=null,i.get=function(e){if(!e&&i.fastMode&&!p.test_experiments)return o();var t=new Date,r=n();l.log("config_get",r,l.DEBUG),c.get("config",r,function(e,i){if(e)l.error("Failed to get config",e,l.DEBUG),p.saveSessionConfig(null,!0);else{var n=i.body;p.saveSessionConfig(n),n?(f.clientConfig(t),l.time("config.get: successfully got session config data",i,t,l.DEBUG)):l.error("No config data in response",null,l.DEBUG)}})},i.buildConfig=s},{"../lib/logger":20,"../lib/session":23,"../lib/tools":26,"./base":2,"./events":4}],4:[function(e,t,i){function n(e,t){var i=new Date;return e.val=(i.getTime()-t.getTime())/1e3,m.enqueue(e)}function r(e){return{type:e,date:(new Date).toISOString(),tvKey:f.attr("title"),tvCl:f.attr("href"),prod:c.isProduction()?1:0,data:{_tl_view:f.toObject()}}}function o(){if(l.log("events.flushQueue: tick.",m,l.LOUD),m.isEmpty()||!d.hasLoadedData)return i.scheduleTick();var e=m.flush(),t=d.getSessionID(),n=g.getLS(b);n&&n.length&&(l.log("Add "+n.length+" events from local storage cache",null,l.DEBUG),e=e.concat(n),g.expire(b,!0)),t||u.post({},"Taplytics::events.flushQueue: failed to create sessions. Events will fail to process."),this.post(e,function(t,n){t&&m.enqueueAll(e),i.scheduleTick()})}function s(){if(!m.isEmpty()&&d.hasLoadedData){var e=m.flush();l.log("save "+e.length+" events to local storage",m,l.DEBUG),g.setLS(b,e)}}var a=e("./base"),u=e("./users"),c=e("../../config"),l=e("../lib/logger"),p=e("../lib/merge"),f=e("../lib/location"),h=e("../lib/queue"),d=e("../lib/session"),g=e("../lib/cookies"),v="events",m=new h,y={active:"appActive",terminate:"appTerminate",config:"tlClientConfig",fastConfig:"tlFastModeConfig",goal:"goalAchieved",pageView:"viewAppeared",pageClose:"viewDisappeared",timeOnPage:"viewTimeOnPage"};i.types=y,i.watchLifecycleEvents=function(){i.appActive();o.bind(this);window.addEventListener("unload",function(){l.log("Window on unload",null,l.DEBUG),i.appTerminate(),s()})},i.timeOnPage=function(e,t,i,n,o,s){var a=r(y.timeOnPage);if(s&&s.getTime){var u=(new Date).getTime(),c=s.getTime();a.val=(u-c)/1e3}return a.vKey=t,a.tKey=e,a.tvKey=n,a.tvCl=i,o&&(a.data=p(a.data||{},{_tl_view:o})),m.enqueue(a)},i.scheduleTick=function(){var e=o.bind(this);setTimeout(e,c.obj().eventsFlushQueueTimeout)},i.pageClose=function(e,t,i,n,o){var s=r(y.pageClose);return s.val=(new Date).toISOString(),s.vKey=t,s.tKey=e,s.tvKey=n,s.tvCl=i,o&&(s.data=p(s.data||{},{_tl_view:o})),m.enqueue(s)},i.pageView=function(e,t,i){var n=r(y.pageView);return i&&(n.data=p(n.data,i)),n.val=(new Date).toISOString(),n.vKey=t,n.tKey=e,m.enqueue(n)},i.goalAchieved=function(e,t,i){var n=r(y.goal);return i&&(n.data=p(n.data,i)),t&&(n.val=t),n.gn=e,m.enqueue(n)},i.appActive=function(){return m.enqueue(r(y.active))},i.appTerminate=function(){return m.enqueue(r(y.terminate))},i.clientConfig=function(e){if(e)return n(r(y.config),e)},i.fastModeConfig=function(e){if(e)return n(r(y.fastConfig),e)},i.post=function(e,t){var i=new Date,n={},r=function(t){var i={};return i.sid=d.getSessionID(),{session:i,events:e}};a.post(v,n,r,function(e,n){return e?l.error("Taplytics::events.post: failed to log events",e,l.LOG):l.time("Taplytics::events.post: succesfully logged events.",n,i,l.DEBUG),t&&t(e,n)})};var b="_tl_eventsQueue"},{"../../config":28,"../lib/cookies":18,"../lib/location":19,"../lib/logger":20,"../lib/merge":21,"../lib/queue":22,"../lib/session":23,"./base":2,"./users":5}],5:[function(e,t,i){var n=e("./base"),r=(e("../lib/source"),e("../lib/logger")),o=e("../lib/session");i.users_path="users",i.del=function(e){o.sessionConfigPromise(function(){var t=o.getAppUserID();if(t){var s={};s.sid=o.getSessionID(),s.ad=o.getDeviceUUID();var a={},u={session:s};r.log("users_del",u,r.DEBUG),n.del(i.users_path+"/"+t,a,u,function(t,i){return t?r.error("Couldn't properly rest user.",i,r.DEBUG):r.log("Successfully reset the user.",i,r.DEBUG),e&&e(t,i)})}})},i.post=function(e,t,s){o.sessionConfigPromise(function(){var a=e,u=o.getSessionAttributes();a||(a={}),a.auid=o.getAppUserID();var c=new Date,l={session:u,app_user:a};r.log("users_post",l,r.DEBUG),n.post(i.users_path,{},l,function(e,i){if(e)r.error(t,e,r.USER);else{var n=i.body;n?(r.time("Users.post: successfully created/updated user.",i,c,r.DEBUG),o.setAppUserID(n.app_user_id),o.setSessionID(n.session_id),o.tick()):r.error(t,null,r.USER)}return s&&s(e,i)})})}},{"../lib/logger":20,"../lib/session":23,"../lib/source":24,"./base":2}],6:[function(e,t,i){var n=e("./base"),r=e("../lib/logger");e("../lib/session");i.post=function(e,t){if(!e)return r.error("No new variable to post to server",null,r.DEBUG);var i=new Date,o={name:e.name,createdAt:new Date,variableType:e.defaultType,defaultVal:e.stringifyValue?e.stringifyValue(e.defaultValue):e.defaultValue};r.log("variable_post",o,r.DEBUG),n.post("variable",{},o,function(e,n){if(e)r.error("Failed to post variable",e,r.DEBUG);else{var o=n.body;o&&o.name&&r.time("Users.post: successfully created new variable.",o,i,r.DEBUG)}return t&&t(e)})}},{"../lib/logger":20,"../lib/session":23,"./base":2}],7:[function(e,t,i){var n={};n.api=e("./api"),n.init=e("./functions/init"),n.isReady=e("./functions/isReady"),n.identify=e("./functions/identify"),n.track=e("./functions/track"),n.page=e("./functions/page"),n.reset=e("./functions/reset"),n.propertiesLoaded=e("./functions/propertiesLoaded"),n.runningExperiments=e("./functions/runningExperiments"),n.variable=e("./functions/variable"),n.codeBlock=e("./functions/codeBlock"),t.exports=n},{"./api":1,"./functions/codeBlock":8,"./functions/identify":9,"./functions/init":10,"./functions/isReady":11,"./functions/page":12,"./functions/propertiesLoaded":13,"./functions/reset":14,"./functions/runningExperiments":15,"./functions/track":16,"./functions/variable":17}],8:[function(e,t,i){var n=e("../lib/logger"),r=e("../lib/session"),o=e("../api/variable");t.exports=function(e,t){return e?void r.configPromise(function(){var i=r.config;if(i){var s=i.dynamicVars?i.dynamicVars[e]:null;if(s){if("Code Block"!==s.variableType)return n.error("Taplytics code block "+e+" default type does not match server: "+s.variableType,null,n.LOG);t&&s.value&&t()}else n.log("New Taplytics Code Block: "+e,null,n.DEBUG),o.post({name:e,defaultType:"Code Block",defaultValue:!1})}}):n.error("No name to run code block",null,n.USER)}},{"../api/variable":6,"../lib/logger":20,"../lib/session":23}],9:[function(e,t,i){function n(e){return!(!e||e&&"object"!=typeof e)}function r(e){var t={customData:{}},i=Object.keys(e),n=0;for(n=0;n<i.length;n++){var r=i[n],s=e[r],a=o(r);a&&a.isTopLevel?t[a.acceptedKey]=s:t.customData[r]=s}return t}function o(e){var t={user_id:["user_id","id","userID","userId","customer_id","member_id"],email:["email","email_address"],name:["name"],firstName:["first_name","firstName"],lastName:["last_name","lastName"],avatarUrl:["avatar","avatarUrl","avatar_url"],age:["age"],gender:["gender"]},i=Object.keys(t),n=0,r=0;for(n=0;n<i.length;n++){var o=i[n],s=t[o];if(s)for(r=0;r<s.length;r++){var a=s[r];if(a&&e&&a==e)return{isTopLevel:!0,acceptedKey:a}}}return{isTopLevel:!1}}var s=e("../lib/logger");t.exports=function(e){if(!this.isReady())return s.error("Taplytics::identify: you have to call Taplytics.init first.",null,s.USER),this;if(!n(e))return s.error("Taplytics::identify: you have to pass in an object with user attributes.",null,s.USER),this;var t=r(e);return this.api.users.post(t,"Taplytics::identify: failed to save the user attributes properly."),this}},{"../lib/logger":20}],10:[function(e,t,i){function n(e){return!(!e||"string"!=typeof e)&&!!e.length}var r=e("../lib/logger"),o=(e("../lib/location"),e("../lib/session")),s=e("../lib/cookies"),a=e("../lib/tools"),u=!0;t.exports=function(e,t){return n(e)?(this.env="production",t&&(this.api.config.startOptions=t,a.isNumber(t.log_level)&&r.setPriorityLevel(t.log_level),t.auto_page_view===!1&&(u=!1),t.env&&(this.env=t.env),t.test_experiments&&(o.test_experiments=t.test_experiments),t.fast_mode&&(this.api.config.fastMode=t.fast_mode),a.isNumber(t.timeout)&&this.api.request.setTimeout(t.timeout)),this._in={},this._in.token=e,this._in.logger=r,this._in.cookies=s,this.api.init(this),o.start(),this.api.config.get(),u&&this.page&&this.page(),this.api.events.scheduleTick(),this.api.events.watchLifecycleEvents(),this):void r.error("An SDK token is required.",null,r.USER)}},{"../lib/cookies":18,"../lib/location":19,"../lib/logger":20,"../lib/session":23,"../lib/tools":26}],11:[function(e,t,i){e("../api");t.exports=function(){return!(!this._in||!this._in.token)}},{"../api":1}],12:[function(e,t,i){function n(){var e=u.get(c.previous_page_view_date);return e&&(e=new Date(e)),{category:u.get(c.previous_page_category),name:u.get(c.previous_page_name),href:u.get(c.previous_page_href),title:u.get(c.previous_page_title),location:u.get(c.previous_page_location,JSON&&JSON.parse),view_date:e}}function r(e,t){u.set(c.previous_page_category,e),u.set(c.previous_page_name,t),u.set(c.previous_page_href,a.attr("href")),u.set(c.previous_page_title,a.attr("title")),u.set(c.previous_page_location,a.toObject(),JSON&&JSON.stringify),u.set(c.previous_page_view_date,(new Date).toISOString())}function o(){u.unset(c.previous_page_category),u.unset(c.previous_page_name),u.unset(c.previous_page_href),u.unset(c.previous_page_title),u.unset(c.previous_page_location),u.unset(c.previous_page_view_date)}var s=e("../lib/logger"),a=e("../lib/location"),u=e("../lib/session"),c={previous_page_href:"p_p_l_h",previous_page_title:"p_p_l_t",previous_page_location:"p_p_l",previous_page_name:"p_p_n",previous_page_category:"p_p_c",previous_page_view_date:"p_p_v_d"};t.exports=function(e,t,i){if(!this.isReady())return s.error("track: you have to call Taplytics.init first.",null,s.USER),this;var a=e,l=t,p=i;if("object"!=typeof t||i?e&&!t&&(a=void 0,l=e):(a=void 0,l=e,p=t),u.tick(),u.get(c.previous_page_href)){var f=n();this.api.events.pageClose(f.category,f.name,f.href,f.title,f.location),this.api.events.timeOnPage(f.category,f.name,f.href,f.title,f.location,f.view_date),o()}return this.api.events.pageView(a,l,p),r(a,l),this}},{"../lib/location":19,"../lib/logger":20,"../lib/session":23}],13:[function(e,t,i){var n=e("../lib/session");t.exports=function(e){n.configPromise(e)}},{"../lib/session":23}],14:[function(e,t,i){var n=e("../lib/logger"),r=e("../lib/session");t.exports=function(){return this.isReady()?(r.tick(),this.api.users.del(),r.resetSession(),this.api.config.get(),this):(n.error("Taplytics::reset: you have to call Taplytics.init first.",null,n.USER),!1)}},{"../lib/logger":20,"../lib/session":23}],15:[function(e,t,i){var n=e("../lib/session");t.exports=function(e){n.configPromise(function(){var t=n.config&&n.config.expVarsNames?n.config.expVarsNames:{};return e&&e(t)})}},{"../lib/session":23}],16:[function(e,t,i){var n=e("../lib/logger"),r=e("../lib/session"),o=e("../lib/tools");t.exports=function(e,t,i){if(!this.isReady())return n.error("track: you have to call Taplytics.init first.",null,n.USER),!1;if(!e)return n.error("track: you have to specify an event name.",null,n.USER),!1;var s=t,a=i;return o.isObjectLike(t)&&!i&&(s=void 0,a=t),s&&!o.isNumber(s)?(n.error("track: if you're passing a value, it has to be a number.",null,n.USER),!1):(r.tick(),this.api.events.goalAchieved(e,s,a),this)}},{"../lib/logger":20,"../lib/session":23,"../lib/tools":26}],17:[function(e,t,i){var n=(e("../lib/session"),e("../tlVariable/tlVariable"));t.exports=function(e,t,i){var r=new n(e,t,i);return r&&r.init?r:null}},{"../lib/session":23,"../tlVariable/tlVariable":27}],18:[function(e,t,i){function n(){return d||(d=new l,r()),d}function r(){if(d&&document.cookie&&document.cookie.length)for(var e,t=document.cookie.split(";"),i=0;i<t.length;i++)try{for(e=t[i];" "==e.charAt(0);)e=e.substring(1);d.setCookies(e)}catch(n){a.error("Exception setting cookie",n,a.DEBUG)}}function o(e,t,i){var n=e+"="+t,r=new p(n);return i&&(r.expiration_date=i),r}function s(){if(void 0!==g)return g;var e=!0;do{var t="gCStest="+Math.floor(1e8*Math.random());if(document.cookie=e?t+";expires=Tue, 01-Jan-2030 00:00:00 GMT":t,document.cookie.indexOf(t)!==-1)return document.cookie=t+";expires=Sat, 01-Jan-2000 00:00:00 GMT",g=e,e}while(!(e=!e));return g=null,null}var a=e("./logger"),u=e("./tools"),c=e("lscache"),l=e("cookiejar").CookieJar,p=e("cookiejar").Cookie,f=e("cookiejar").CookieAccessInfo,h=new f;c.supported()||(a.log("Local Storage not supported",null,a.DEBUG),c=null),i.getJSON=function(e,t){var n=i.get(e,t);if(!n||!u.isString(n))return n;try{return JSON.parse(n)}catch(r){return a.error("JSON parse cookie value",r,a.DEBUG),null}},i.getLS=function(e){if(!c)return null;var t=c.get(e);return a.log("Got local storage key: "+e+" with value: "+t,null,a.LOUD),t},i.get=function(e,t){if(s()&&!t){var r=n(),o=r.getCookie(e,h);if(!o)return;return o.value}return c?i.getLS(e):t?i.get(e):void 0},i.setJSON=function(e,t,n,r){var o;try{o=u.isString(t)?t:JSON.stringify(t)}catch(s){a.error("JSON stringify cookie value",s,a.DEBUG)}i.set(e,o,n,r)},i.set=function(e,t,r,u){if(e)if(s()&&!u){t=t||"",r=r||{};var l=n(),p=o(e,t,r.expires),f=p.toString();document.cookie=f,l.setCookie(f),a.log("Setting cookies to:",f,a.LOUD)}else c?i.setLS(e,t,r):u&&i.set(e,t,r)},i.setLS=function(e,t,i){if(c){var n=i&&i.expires?30:null;c.set(e,t,n),a.log("Setting local storage key: "+e+" to value: "+t,null,a.LOUD)}},i.expire=function(e,t){s()&&!t?i.set(e,"-",{expires:new Date}):c?(a.log("Deleting local storage key: "+e,a.LOUD),c.remove(e)):t&&i.expire(e)};var d,g=void 0},{"./logger":20,"./tools":26,cookiejar:31,lscache:32}],19:[function(e,t,i){function n(e){return r[e]?r[e]:"title"===e?document.title:document.location?document.location[e]:null}var r=(e("../lib/swizzle"),e("./logger"),{});i.toObject=function(){return{href:n("href"),hash:n("hash"),search:n("search"),host:n("host"),protocol:n("protocol"),pathname:n("pathname"),title:n("title")}},i.attr=function(e){return n(e)},i.listen=function(e){}},{"../lib/swizzle":25,"./logger":20}],20:[function(e,t,i){function n(e){return r>=e}var r=0;i.LOUD=3,i.DEBUG=2,i.LOG=1,i.USER=0,i.setPriorityLevel=function(e){r=e},i.log=function(e,t,i){(void 0===i||n(i))&&(console.log("[Taplytics]",e),t&&console.dir(t))},i.time=function(e,t,r,o){if(void 0===o||n(o)){if(r){var s=new Date,a=s.getTime()-r.getTime();e=e+", time: "+a+"ms"}i.log(e,t,o)}},i.error=function(e,t,i){(void 0===i||n(i))&&(console.error("[Taplytics]",e),t&&console.dir(t))}},{}],21:[function(e,t,i){t.exports=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}},{}],22:[function(e,t,i){function n(){var e=[];this.length=function(){return e.length},this.isEmpty=function(){return 0===e.length},this.enqueue=function(t){e.push(t)},this.enqueueAll=function(e){if(!e||e&&"array"!=typeof e)return 0;var t=0;for(t=0;t<e.length;t++){var i=e[t];this.enqueue(i)}return e.length},this.dequeue=function(){if(0!=e.length)return e.shift()},this.flush=function(){var t=e.slice();return e=[],t},this.peek=function(){return e.length>0?e[0]:void 0}}t.exports=n},{}],23:[function(e,t,i){function n(e,t,i){var n=new Date(e);switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+i);break;case"quarter":n.setMonth(n.getMonth()+3*i);break;case"month":n.setMonth(n.getMonth()+i);break;case"week":n.setDate(n.getDate()+7*i);break;case"day":n.setDate(n.getDate()+i);break;case"hour":n.setTime(n.getTime()+36e5*i);break;case"minute":n.setTime(n.getTime()+6e4*i);break;case"second":n.setTime(n.getTime()+1e3*i);break;default:n=void 0}return n}var r=e("./cookies"),o=e("uuid"),s=e("./logger"),a=e("../../config"),u=e("../lib/source"),c=e("../lib/location"),l={cookieSessionID:"_tl_csid",deviceUUID:"_tl_duuid",sessionUUID:"_tl_suuid",sessionID:"_tl_sid",appUserID:"_tl_auid",cachedConfig:"_tl_config",sessionOptions:function(e,t){return e&&t?"tl_sopts_"+e+"_"+t:null}};i.config=null,i.hasLoadedData=!1,i.start=function(){return i.updateCookieSession().setDeviceUUID(),i},i.get=function(e,t){if(e){i.tick();var n=i.getCookieSessionID(),o=l.sessionOptions(n,e);if(o){if(!(t&&JSON&&JSON.parse))return r.get(o);var a=r.get(o);if(a&&"object"==typeof a)return a;try{return JSON.parse(a)}catch(u){return s.error("Session.get("+e+") failed to parse JSON.",u,s.DEBUG),a}}}},i.tick=function(){return i.updateCookieSession(),i},i.set=function(e,t,o){if(!e||void 0===t||0===(""+t).length)return!1;i.tick();var s=i.getCookieSessionID(),a=l.sessionOptions(s,e),u=n(new Date,"minute",30),c=t;return!!a&&(o&&JSON&&JSON.stringify&&(c=JSON.stringify(t)),r.set(a,c,{expires:u}),!0)},i.unset=function(e){if(!e)return!1;i.tick();var t=i.getCookieSessionID(),n=l.sessionOptions(t,e);r.expire(n)},i.updateCookieSession=function(){var e=i.getCookieSessionID();e||(e=o.v4(),i.deleteSessionID());var t=n(new Date,"minute",30);return r.set(l.cookieSessionID,e,{expires:t}),s.log("Set cookieSessionID to: "+e,{expires:t},s.LOUD),i},i.setDeviceUUID=function(){var e=i.getDeviceUUID();return e||(e=o.v4()),r.set(l.deviceUUID,e,{expires:new Date(2147483647e3)}),s.log("Set deviceUUID to: "+e,null,s.DEBUG),i},i.setSessionID=function(e){return r.set(l.sessionID,e),s.log("Set sessionID to: "+e,null,s.DEBUG),i},i.deleteSessionID=function(){return r.expire(l.sessionID),i},i.setAppUserID=function(e){return r.set(l.appUserID,e),s.log("Set appUserID to: "+e,null,s.DEBUG),i},i.deleteAppUserID=function(){return r.expire(l.appUserID),i},i.deleteSessionUUID=function(){r.expire(l.sessionUUID)},i.setCachedConfig=function(e){return r.setJSON(l.cachedConfig,{expVarsNamesHistory:e?e.expVarsNamesHistory:{},expVarsNames:e?e.expVarsNames:{},expVarsIds:e?e.expVarsIds:{},dynamicVars:e?e.dynamicVars:{}},null,!0),i},i.getDeviceUUID=function(){return r.get(l.sessionUUID)?r.get(l.sessionUUID):(r.get(l.sessionUUID)===r.get(l.deviceUUID)&&i.deleteSessionUUID(),r.get(l.deviceUUID))},i.getCookieSessionID=function(){return r.get(l.cookieSessionID)},i.getAppUserID=function(){return r.get(l.appUserID)},i.getSessionID=function(){return r.get(l.sessionID)},i.getCachedConfig=function(){return r.getJSON(l.cachedConfig,!0)},i.getSessionAttributes=function(e){e=e||{};var t=c.toObject(),i=u();return e.sid=this.getSessionID(),e.ad=this.getDeviceUUID(),e.adt="browser",e.ct="browser",e.lv=a.isProduction()?"0":"1",e.sdk=a.sdkVersion,e.rfr=i.referrer,e.exm=i.search.utm_medium,e.exs=i.search.utm_source,e.exc=i.search.utm_campaign,e.ext=i.search.utm_term,e.exct=i.search.utm_content,e.prms={search:i.search,location:t},navigator&&navigator.userAgent&&(e.prms.userAgent=navigator.userAgent),e},i.saveSessionConfig=function(e,t){if(t&&!e&&(s.log("Using cached config because of server error",null,s.DEBUG),e=i.getCachedConfig()),i.config=e,i.hasConfigData=!0,e&&e.app_user_id&&e.session_id&&(i.hasLoadedData=!0,i.setAppUserID(e.app_user_id),i.setSessionID(e.session_id),i.tick()),e){i.setCachedConfig(e);for(var n=0;n<i.configPromises.length;n++){var r=i.configPromises[n];r&&r(!!e)}i.configPromises=[]}if(t||e&&e.app_user_id&&e.session_id){for(var n=0;n<i.sessionConfigPromises.length;n++){var r=i.sessionConfigPromises[n];r&&r(!!e)}i.sessionConfigPromises=[]}},i.sessionConfigPromises=[],i.sessionConfigPromise=function(e){if(e)return i.hasLoadedData&&i.config?e(!0):void i.sessionConfigPromises.push(e)},i.hasConfigData=!1,i.configPromises=[],i.configPromise=function(e){if(e)return i.hasConfigData&&i.config?e(!0):void i.configPromises.push(e)},i.resetSession=function(){i.deleteSessionID(),i.deleteAppUserID(),i.config=null,i.hasLoadedData=!1}},{"../../config":28,"../lib/location":19,"../lib/source":24,"./cookies":18,"./logger":20,uuid:45}],24:[function(e,t,i){var n=e("qs");t.exports=function(){var e={},t=null;location&&location.search&&location.search.length&&(e=n.parse(location.search.substr(1))),document&&document.referrer&&(t=document.referrer);var i={referrer:t,search:e};return i}},{qs:33}],25:[function(e,t,i){t.exports=function(e,t,i,n){if(!e)return!1;if(!t||"string"!=typeof t)return!1;if(!i||"function"!=typeof i)return!1;if(!e[t])return!1;var r=e[t];return function(n){e[t]=function(){i.apply(n,arguments),r.apply(n,arguments)}}(n),!0}},{}],26:[function(e,t,i){var n=Object.prototype.toString,r="[object Number]",o="[object String]";i.isNumber=function(e){return"number"==typeof e||i.isObjectLike(e)&&n.call(e)==r},i.isString=function(e){return"string"==typeof e||i.isObjectLike(e)&&n.call(e)==o},i.isObjectLike=function(e){return!!e&&"object"==typeof e}},{}],27:[function(e,t,i){function n(e,t,i){return this.init=!1,e?(this.name=e,this.defaultValue=t,this.value=t,this.updatedBlock=i,this.defaultType=this.getValueType(t),this.defaultType?(this.init=!0,void this.getValueFromConfig()):r.log("Error: Taplytics variables only support Strings, Numbers, and Booleans.",null,r.USER)):r.log("Error: Taplytics variable is missing a name",null,r.USER)}var r=e("../lib/logger"),o=e("../lib/session"),s=e("../api/variable");n.prototype.getValueType=function(e){return"string"==typeof e?"String":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"object"==typeof e?"JSON":null},n.prototype.stringifyValue=function(e){return"JSON"===this.defaultType?JSON.stringify(e):e},n.prototype.parseValue=function(e){if("JSON"===this.defaultType){if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){r.log("Error parsing JSON variable",e,r.LOG)}return nil}return e},n.prototype.getValueFromConfig=function(){var e=this;o.configPromise(function(){var t=o.config,i=t&&t.dynamicVars?t.dynamicVars[e.name]:null;if(i){if(i.variableType!==e.defaultType)return r.error("Taplytics variable "+e.name+" default type does not match server: "+i.variableType,null,r.LOG);e.value=e.parseValue(i.value)}else t&&(r.log("New Taplytics Variable: "+e.name,null,r.DEBUG),s.post(e));e.updatedBlock&&e.updatedBlock(e.value)})},t.exports=n},{"../api/variable":6,"../lib/logger":20,"../lib/session":23}],28:[function(e,t,i){i.obj=function(){var t=e("./app/app"),i={cdnAPI:"https://cdn-config.taplytics.com/js/"};return"production"===t.env?(i.baseAPI="https://api.taplytics.com/public_api/v1/",i.eventsAPI="https://ping.taplytics.com/public_api/v1/"):"dev"===t.env||"development"===t.env?i.baseAPI="https://dev.taplytics.com/public_api/v1/":"stag"===t.env||"staging"===t.env?i.baseAPI="https://staging.taplytics.com/public_api/v1/":"local"===t.env&&(i.baseAPI="http://localhost:3002/public_api/v1/"),i.eventsFlushQueueTimeout=4e3,i.functionFlushQueueTimeout=500,i.sdkVersion="1.2.4",i},i.isProduction=function(){var t=e("./app/app");return"production"===t.env}},{"./app/app":7}],29:[function(e,t,i){var n=e("./app"),r=e("./lib/logger"),o=e("../config");i.Taplytics=window.Taplytics=t.exports=n,i.flushAppQueue=function(){if(r.log("flushAppQueue tick",window._tlq,r.LOUD),window._tlq&&window._tlq instanceof Array){var e=window._tlq.slice();if(window._tlq=[],Array.prototype.sort&&e.sort(function(e,t){if(e instanceof Array&&t instanceof Array){if("init"===e[0]&&"identify"===t[0])return-1;if("identify"===e[0]&&"init"===t[0])return 1;if("init"===e[0]||"identify"==e[0])return-1}return 2}),e.length>0){r.log("flushAppQueue: "+e.length,e,r.LOUD);for(var t=0;t<e.length;t++){var s=e[t],a=s.shift(),u=s;if(n[a]&&n[a]instanceof Function)try{n[a].apply(n,u)}catch(c){r.error("Attempted to call "+a+"("+(u||[]).join(",")+"); from the queue but failed!",c,r.USER),c&&c.stack&&r.error(c.stack,null,r.DEBUG)}}}}setTimeout(i.flushAppQueue,o.obj().functionFlushQueueTimeout)},i.flushAppQueue()},{"../config":28,"./app":7,"./lib/logger":20}],30:[function(e,t,i){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}"undefined"!=typeof t&&(t.exports=n),n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n,r=0;r<i.length;r++)if(n=i[r],n===t||n.fn===t){i.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks["$"+e];if(i){i=i.slice(0);for(var n=0,r=i.length;n<r;++n)i[n].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],31:[function(e,t,i){!function(){"use strict";function e(t,i,n,r){return this instanceof e?(this.domain=t||void 0,this.path=i||"/",this.secure=!!n,this.script=!!r,this):new e(t,i,n,r)}function t(e,i,n){return e instanceof t?e:this instanceof t?(this.name=null,this.value=null,this.expiration_date=1/0,this.path=String(n||"/"),this.explicit_path=!1,this.domain=i||null,this.explicit_domain=!1,this.secure=!1,this.noscript=!1,e&&this.parse(e,i,n),this):new t(e,i,n)}function n(){var e,i,r;return this instanceof n?(e=Object.create(null),this.setCookie=function(n,o,s){var a,u;if(n=new t(n,o,s),a=n.expiration_date<=Date.now(),void 0!==e[n.name]){for(i=e[n.name],u=0;u<i.length;u+=1)if(r=i[u],r.collidesWith(n))return a?(i.splice(u,1),0===i.length&&delete e[n.name],!1):(i[u]=n,n);return!a&&(i.push(n),n)}return!a&&(e[n.name]=[n],e[n.name])},this.getCookie=function(t,n){var r,o;if(i=e[t])for(o=0;o<i.length;o+=1)if(r=i[o],r.expiration_date<=Date.now())0===i.length&&delete e[r.name];else if(r.matches(n))return r},this.getCookies=function(t){var i,n,r=[];for(i in e)n=this.getCookie(i,t),n&&r.push(n);return r.toString=function(){return r.join(":")},r.toValueString=function(){return r.map(function(e){return e.toValueString()}).join(";")},r},this):new n}e.All=Object.freeze(Object.create(null)),i.CookieAccessInfo=e,i.Cookie=t,t.prototype.toString=function(){var e=[this.name+"="+this.value];return this.expiration_date!==1/0&&e.push("expires="+new Date(this.expiration_date).toGMTString()),
this.domain&&e.push("domain="+this.domain),this.path&&e.push("path="+this.path),this.secure&&e.push("secure"),this.noscript&&e.push("httponly"),e.join("; ")},t.prototype.toValueString=function(){return this.name+"="+this.value};var r=/[:](?=\s*[a-zA-Z0-9_\-]+\s*[=])/g;t.prototype.parse=function(e,i,n){if(this instanceof t){var r,o=e.split(";").filter(function(e){return!!e}),s=o[0].match(/([^=]+)=([\s\S]*)/),a=s[1],u=s[2];for(this.name=a,this.value=u,r=1;r<o.length;r+=1)switch(s=o[r].match(/([^=]+)(?:=([\s\S]*))?/),a=s[1].trim().toLowerCase(),u=s[2],a){case"httponly":this.noscript=!0;break;case"expires":this.expiration_date=u?Number(Date.parse(u)):1/0;break;case"path":this.path=u?u.trim():"",this.explicit_path=!0;break;case"domain":this.domain=u?u.trim():"",this.explicit_domain=!!this.domain;break;case"secure":this.secure=!0}return this.explicit_path||(this.path=n||"/"),this.explicit_domain||(this.domain=i),this}return(new t).parse(e,i,n)},t.prototype.matches=function(t){return t===e.All||!(this.noscript&&t.script||this.secure&&!t.secure||!this.collidesWith(t))},t.prototype.collidesWith=function(e){if(this.path&&!e.path||this.domain&&!e.domain)return!1;if(this.path&&0!==e.path.indexOf(this.path))return!1;if(this.explicit_path&&0!==e.path.indexOf(this.path))return!1;var t=e.domain&&e.domain.replace(/^[\.]/,""),i=this.domain&&this.domain.replace(/^[\.]/,"");if(i===t)return!0;if(i){if(!this.explicit_domain)return!1;var n=t.indexOf(i);return n!==-1&&n===t.length-i.length}return!0},i.CookieJar=n,n.prototype.setCookies=function(e,i,n){e=Array.isArray(e)?e:e.split(r);var o,s,a=[];for(e=e.map(function(e){return new t(e,i,n)}),o=0;o<e.length;o+=1)s=e[o],this.setCookie(s,i,n)&&a.push(s);return a}}()},{}],32:[function(e,t,i){!function(e,i){"undefined"!=typeof t&&t.exports?t.exports=i():e.lscache=i()}(this,function(){function e(){var e="__lscachetest__",i=e;if(void 0!==h)return h;try{if(!localStorage)return!1}catch(n){return!1}try{a(e,i),u(e),h=!0}catch(r){h=!(!t(r)||!localStorage.length)}return h}function t(e){return!!(e&&"QUOTA_EXCEEDED_ERR"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||"QuotaExceededError"===e.name)}function i(){return void 0===d&&(d=null!=window.JSON),d}function n(e){return e.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")}function r(e){return e+v}function o(){return Math.floor((new Date).getTime()/y)}function s(e){return localStorage.getItem(g+_+e)}function a(e,t){localStorage.removeItem(g+_+e),localStorage.setItem(g+_+e,t)}function u(e){localStorage.removeItem(g+_+e)}function c(e){for(var t=new RegExp("^"+g+n(_)+"(.*)"),i=localStorage.length-1;i>=0;--i){var o=localStorage.key(i);o=o&&o.match(t),o=o&&o[1],o&&o.indexOf(v)<0&&e(o,r(o))}}function l(e){var t=r(e);u(e),u(t)}function p(e){var t=r(e),i=s(t);if(i){var n=parseInt(i,m);if(o()>=n)return u(e),u(t),!0}}function f(e,t){w&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+e),t&&window.console.warn("lscache - The error was: "+t.message))}var h,d,g="lscache-",v="-cacheexpiration",m=10,y=6e4,b=Math.floor(864e13/y),_="",w=!1,D={set:function(n,p,h){if(e()){if("string"!=typeof p){if(!i())return;try{p=JSON.stringify(p)}catch(d){return}}try{a(n,p)}catch(d){if(!t(d))return void f("Could not add item with key '"+n+"'",d);var g,v=[];c(function(e,t){var i=s(t);i=i?parseInt(i,m):b,v.push({key:e,size:(s(e)||"").length,expiration:i})}),v.sort(function(e,t){return t.expiration-e.expiration});for(var y=(p||"").length;v.length&&y>0;)g=v.pop(),f("Cache is full, removing item with key '"+n+"'"),l(g.key),y-=g.size;try{a(n,p)}catch(d){return void f("Could not add item with key '"+n+"', perhaps it's too big?",d)}}h?a(r(n),(o()+h).toString(m)):u(r(n))}},get:function(t){if(!e())return null;if(p(t))return null;var n=s(t);if(!n||!i())return n;try{return JSON.parse(n)}catch(r){return n}},remove:function(t){e()&&l(t)},supported:function(){return e()},flush:function(){e()&&c(function(e){l(e)})},flushExpired:function(){e()&&c(function(e){p(e)})},setBucket:function(e){_=e},resetBucket:function(){_=""},enableWarnings:function(e){w=e}};return D})},{}],33:[function(e,t,i){t.exports=e("./lib/")},{"./lib/":34}],34:[function(e,t,i){var n=e("./stringify"),r=e("./parse");t.exports={stringify:n,parse:r}},{"./parse":35,"./stringify":36}],35:[function(e,t,i){var n=e("./utils"),r={delimiter:"&",depth:5,arrayLimit:20,parameterLimit:1e3};r.parseValues=function(e,t){for(var i={},r=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),o=0,s=r.length;o<s;++o){var a=r[o],u=a.indexOf("]=")===-1?a.indexOf("="):a.indexOf("]=")+1;if(u===-1)i[n.decode(a)]="";else{var c=n.decode(a.slice(0,u)),l=n.decode(a.slice(u+1));Object.prototype.hasOwnProperty.call(i,c)?i[c]=[].concat(i[c]).concat(l):i[c]=l}}return i},r.parseObject=function(e,t,i){if(!e.length)return t;var n=e.shift(),o={};if("[]"===n)o=[],o=o.concat(r.parseObject(e,t,i));else{var s="["===n[0]&&"]"===n[n.length-1]?n.slice(1,n.length-1):n,a=parseInt(s,10),u=""+a;!isNaN(a)&&n!==s&&u===s&&a>=0&&a<=i.arrayLimit?(o=[],o[a]=r.parseObject(e,t,i)):o[s]=r.parseObject(e,t,i)}return o},r.parseKeys=function(e,t,i){if(e){var n=/^([^\[\]]*)/,o=/(\[[^\[\]]*\])/g,s=n.exec(e);if(!Object.prototype.hasOwnProperty(s[1])){var a=[];s[1]&&a.push(s[1]);for(var u=0;null!==(s=o.exec(e))&&u<i.depth;)++u,Object.prototype.hasOwnProperty(s[1].replace(/\[|\]/g,""))||a.push(s[1]);return s&&a.push("["+e.slice(s.index)+"]"),r.parseObject(a,t,i)}}},t.exports=function(e,t){if(""===e||null===e||"undefined"==typeof e)return{};t=t||{},t.delimiter="string"==typeof t.delimiter||n.isRegExp(t.delimiter)?t.delimiter:r.delimiter,t.depth="number"==typeof t.depth?t.depth:r.depth,t.arrayLimit="number"==typeof t.arrayLimit?t.arrayLimit:r.arrayLimit,t.parameterLimit="number"==typeof t.parameterLimit?t.parameterLimit:r.parameterLimit;for(var i="string"==typeof e?r.parseValues(e,t):e,o={},s=Object.keys(i),a=0,u=s.length;a<u;++a){var c=s[a],l=r.parseKeys(c,i[c],t);o=n.merge(o,l)}return n.compact(o)}},{"./utils":37}],36:[function(e,t,i){var n=e("./utils"),r={delimiter:"&",arrayPrefixGenerators:{brackets:function(e,t){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e,t){return e}}};r.stringify=function(e,t,i){if(n.isBuffer(e)?e=e.toString():e instanceof Date?e=e.toISOString():null===e&&(e=""),"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return[encodeURIComponent(t)+"="+encodeURIComponent(e)];var o=[];if("undefined"==typeof e)return o;for(var s=Object.keys(e),a=0,u=s.length;a<u;++a){var c=s[a];o=Array.isArray(e)?o.concat(r.stringify(e[c],i(t,c),i)):o.concat(r.stringify(e[c],t+"["+c+"]",i))}return o},t.exports=function(e,t){t=t||{};var i="undefined"==typeof t.delimiter?r.delimiter:t.delimiter,n=[];if("object"!=typeof e||null===e)return"";var o;o=t.arrayFormat in r.arrayPrefixGenerators?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":"indices";for(var s=r.arrayPrefixGenerators[o],a=Object.keys(e),u=0,c=a.length;u<c;++u){var l=a[u];n=n.concat(r.stringify(e[l],l,s))}return n.join(i)}},{"./utils":37}],37:[function(e,t,i){i.arrayToObject=function(e){for(var t={},i=0,n=e.length;i<n;++i)"undefined"!=typeof e[i]&&(t[i]=e[i]);return t},i.merge=function(e,t){if(!t)return e;if("object"!=typeof t)return Array.isArray(e)?e.push(t):e[t]=!0,e;if("object"!=typeof e)return e=[e].concat(t);Array.isArray(e)&&!Array.isArray(t)&&(e=i.arrayToObject(e));for(var n=Object.keys(t),r=0,o=n.length;r<o;++r){var s=n[r],a=t[s];e[s]?e[s]=i.merge(e[s],a):e[s]=a}return e},i.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},i.compact=function(e,t){if("object"!=typeof e||null===e)return e;t=t||[];var n=t.indexOf(e);if(n!==-1)return t[n];if(t.push(e),Array.isArray(e)){for(var r=[],o=0,s=e.length;o<s;++o)"undefined"!=typeof e[o]&&r.push(e[o]);return r}var a=Object.keys(e);for(o=0,s=a.length;o<s;++o){var u=a[o];e[u]=i.compact(e[u],t)}return e},i.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},i.isBuffer=function(e){return null!==e&&"undefined"!=typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},{}],38:[function(e,t,i){function n(){}function r(e){if(!g(e))return e;var t=[];for(var i in e)o(t,i,e[i]);return t.join("&")}function o(e,t,i){if(null!=i)if(Array.isArray(i))i.forEach(function(i){o(e,t,i)});else if(g(i))for(var n in i)o(e,t+"["+n+"]",i[n]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));else null===i&&e.push(encodeURIComponent(t))}function s(e){for(var t,i,n={},r=e.split("&"),o=0,s=r.length;o<s;++o)t=r[o],i=t.indexOf("="),i==-1?n[decodeURIComponent(t)]="":n[decodeURIComponent(t.slice(0,i))]=decodeURIComponent(t.slice(i+1));return n}function a(e){var t,i,n,r,o=e.split(/\r?\n/),s={};o.pop();for(var a=0,u=o.length;a<u;++a)i=o[a],t=i.indexOf(":"),n=i.slice(0,t).toLowerCase(),r=_(i.slice(t+1)),s[n]=r;return s}function u(e){return/[\/+]json\b/.test(e)}function c(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function l(e,t){var i=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new c(i)}catch(n){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=n,i.xhr?(e.rawResponse="undefined"==typeof i.xhr.responseType?i.xhr.responseText:i.xhr.response,e.status=i.xhr.status?i.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),i.callback(e)}i.emit("response",t);var r;try{i._isResponseOK(t)||(r=new Error(t.statusText||"Unsuccessful HTTP response"),r.original=e,r.response=t,r.status=t.status)}catch(n){r=n}r?i.callback(r,t):i.callback(null,t)})}function p(e,t,i){var n=b("DELETE",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n}var f;"undefined"!=typeof window?f=window:"undefined"!=typeof self?f=self:(console.warn("Using browser-only version of superagent in non-browser environment"),f=this);var h=e("component-emitter"),d=e("./request-base"),g=e("./is-object"),v=e("./is-function"),m=e("./response-base"),y=e("./should-retry"),b=i=t.exports=function(e,t){return"function"==typeof t?new i.Request("GET",e).end(t):1==arguments.length?new i.Request("GET",e):new i.Request(e,t)};i.Request=l,b.getXHR=function(){if(!(!f.XMLHttpRequest||f.location&&"file:"==f.location.protocol&&f.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only verison of superagent could not find XHR")};var _="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};b.serializeObject=r,b.parseString=s,b.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},b.serialize={"application/x-www-form-urlencoded":r,"application/json":JSON.stringify},b.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},m(c.prototype),c.prototype._parseBody=function(e){var t=b.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&u(this.type)&&(t=b.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},c.prototype.toError=function(){var e=this.req,t=e.method,i=e.url,n="cannot "+t+" "+i+" ("+this.status+")",r=new Error(n);return r.status=this.status,r.method=t,r.url=i,r},b.Response=c,h(l.prototype),d(l.prototype),l.prototype.type=function(e){return this.set("Content-Type",b.types[e]||e),this},l.prototype.accept=function(e){return this.set("Accept",b.types[e]||e),this},l.prototype.auth=function(e,t,i){switch("object"==typeof t&&null!==t&&(i=t),i||(i={type:"function"==typeof btoa?"basic":"auto"}),i.type){case"basic":this.set("Authorization","Basic "+btoa(e+":"+t));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e)}return this},l.prototype.query=function(e){return"string"!=typeof e&&(e=r(e)),e&&this._query.push(e),this},l.prototype.attach=function(e,t,i){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,i||t.name)}return this},l.prototype._getFormData=function(){return this._formData||(this._formData=new f.FormData),this._formData},l.prototype.callback=function(e,t){if(this._maxRetries&&this._retries++<this._maxRetries&&y(e,t))return this._retry();var i=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),i(e,t)},l.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},l.prototype.buffer=l.prototype.ca=l.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},l.prototype.pipe=l.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},l.prototype._appendQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+e),this._sort){var t=this.url.indexOf("?");if(t>=0){var i=this.url.substring(t+1).split("&");v(this._sort)?i.sort(this._sort):i.sort(),this.url=this.url.substring(0,t)+"?"+i.join("&")}}},l.prototype._isHost=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},l.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||n,this._appendQueryString(),this._end()},l.prototype._end=function(){var e=this,t=this.xhr=b.getXHR(),i=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var i=t.readyState;if(i>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==i){var n;try{n=t.status}catch(r){n=0}if(!n){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var n=function(t,i){i.total>0&&(i.percent=i.loaded/i.total*100),i.direction=t,e.emit("progress",i)};if(this.hasListeners("progress"))try{t.onprogress=n.bind(null,"download"),t.upload&&(t.upload.onprogress=n.bind(null,"upload"))}catch(r){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(o){return this.callback(o)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof i&&!this._isHost(i)){var s=this._header["content-type"],a=this._serializer||b.serialize[s?s.split(";")[0]:""];!a&&u(s)&&(a=b.serialize["application/json"]),a&&(i=a(i))}for(var c in this.header)null!=this.header[c]&&this.header.hasOwnProperty(c)&&t.setRequestHeader(c,this.header[c]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send("undefined"!=typeof i?i:null),this},b.get=function(e,t,i){var n=b("GET",e);return"function"==typeof t&&(i=t,t=null),t&&n.query(t),i&&n.end(i),n},b.head=function(e,t,i){var n=b("HEAD",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},b.options=function(e,t,i){var n=b("OPTIONS",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},b.del=p,b["delete"]=p,b.patch=function(e,t,i){var n=b("PATCH",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},b.post=function(e,t,i){var n=b("POST",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},b.put=function(e,t,i){var n=b("PUT",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n}},{"./is-function":39,"./is-object":40,"./request-base":41,"./response-base":42,"./should-retry":43,"component-emitter":30}],39:[function(e,t,i){function n(e){var t=r(e)?Object.prototype.toString.call(e):"";return"[object Function]"===t}var r=e("./is-object");t.exports=n},{"./is-object":40}],40:[function(e,t,i){function n(e){return null!==e&&"object"==typeof e}t.exports=n},{}],41:[function(e,t,i){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}var o=e("./is-object");t.exports=n,n.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},n.prototype.parse=function(e){return this._parser=e,this},n.prototype.responseType=function(e){return this._responseType=e,this},n.prototype.serialize=function(e){return this._serializer=e,this},n.prototype.timeout=function(e){if(!e||"object"!=typeof e)return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}return this},n.prototype.retry=function(e){return 0!==arguments.length&&e!==!0||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this},n.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},n.prototype.then=function(e,t){if(!this._fullfilledPromise){var i=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(e,t){i.end(function(i,n){i?t(i):e(n)})})}return this._fullfilledPromise.then(e,t)},n.prototype["catch"]=function(e){return this.then(void 0,e)},n.prototype.use=function(e){return e(this),this},n.prototype.ok=function(e){if("function"!=typeof e)throw Error("Callback required");return this._okCallback=e,this},n.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},n.prototype.get=function(e){return this._header[e.toLowerCase()]},n.prototype.getHeader=n.prototype.get,n.prototype.set=function(e,t){if(o(e)){for(var i in e)this.set(i,e[i]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},n.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},n.prototype.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),o(e)){for(var i in e)this.field(i,e[i]);return this}if(Array.isArray(t)){for(var n in t)this.field(e,t[n]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=""+t),this._getFormData().append(e,t),this},n.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},n.prototype.withCredentials=function(e){return void 0==e&&(e=!0),this._withCredentials=e,this},n.prototype.redirects=function(e){return this._maxRedirects=e,this},n.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},n.prototype.send=function(e){var t=o(e),i=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(t&&o(this._data))for(var n in e)this._data[n]=e[n];else"string"==typeof e?(i||this.type("form"),i=this._header["content-type"],"application/x-www-form-urlencoded"==i?this._data=this._data?this._data+"&"+e:e:this._data=(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(i||this.type("json"),this)},n.prototype.sortQuery=function(e){return this._sort="undefined"==typeof e||e,this},n.prototype._timeoutError=function(e,t,i){if(!this._aborted){var n=new Error(e+t+"ms exceeded");n.timeout=t,n.code="ECONNABORTED",n.errno=i,this.timedout=!0,this.abort(),this.callback(n)}},n.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},{"./is-object":40}],42:[function(e,t,i){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}var o=e("./utils");t.exports=n,n.prototype.get=function(e){return this.header[e.toLowerCase()]},n.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=o.type(t);var i=o.params(t);for(var n in i)this[n]=i[n];this.links={};try{e.link&&(this.links=o.parseLinks(e.link))}catch(r){}},n.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e}},{"./utils":44}],43:[function(e,t,i){var n=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];t.exports=function(e,t){return!!(e&&e.code&&~n.indexOf(e.code))||(!!(t&&t.status&&t.status>=500)||(!!(e&&"timeout"in e&&"ECONNABORTED"==e.code)||!!(e&&"crossDomain"in e)))}},{}],44:[function(e,t,i){i.type=function(e){return e.split(/ *; */).shift()},i.params=function(e){return e.split(/ *; */).reduce(function(e,t){var i=t.split(/ *= */),n=i.shift(),r=i.shift();return n&&r&&(e[n]=r),e},{})},i.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var i=t.split(/ *; */),n=i[0].slice(1,-1),r=i[1].split(/ *= */)[1].slice(1,-1);return e[r]=n,e},{})},i.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&delete e.cookie,e}},{}],45:[function(e,t,i){var n=e("./v1"),r=e("./v4"),o=r;o.v1=n,o.v4=r,t.exports=o},{"./v1":48,"./v4":49}],46:[function(e,t,i){function n(e,t){var i=t||0,n=r;return n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]}for(var r=[],o=0;o<256;++o)r[o]=(o+256).toString(16).substr(1);t.exports=n},{}],47:[function(e,t,i){(function(e){var i,n=e.crypto||e.msCrypto;if(n&&n.getRandomValues){var r=new Uint8Array(16);i=function(){return n.getRandomValues(r),r}}if(!i){var o=new Array(16);i=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(e,t,i){function n(e,t,i){var n=t&&i||0,r=t||[];e=e||{};var s=void 0!==e.clockseq?e.clockseq:u,p=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:l+1,h=p-c+(f-l)/1e4;if(h<0&&void 0===e.clockseq&&(s=s+1&16383),(h<0||p>c)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,l=f,u=s,p+=122192928e5;var d=(1e4*(268435455&p)+f)%4294967296;r[n++]=d>>>24&255,r[n++]=d>>>16&255,r[n++]=d>>>8&255,r[n++]=255&d;var g=p/4294967296*1e4&268435455;r[n++]=g>>>8&255,r[n++]=255&g,r[n++]=g>>>24&15|16,r[n++]=g>>>16&255,r[n++]=s>>>8|128,r[n++]=255&s;for(var v=e.node||a,m=0;m<6;++m)r[n+m]=v[m];return t?t:o(r)}var r=e("./lib/rng"),o=e("./lib/bytesToUuid"),s=r(),a=[1|s[0],s[1],s[2],s[3],s[4],s[5]],u=16383&(s[6]<<8|s[7]),c=0,l=0;t.exports=n},{"./lib/bytesToUuid":46,"./lib/rng":47}],49:[function(e,t,i){function n(e,t,i){var n=t&&i||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var s=e.random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[n+a]=s[a];return t||o(s)}var r=e("./lib/rng"),o=e("./lib/bytesToUuid");t.exports=n},{"./lib/bytesToUuid":46,"./lib/rng":47}]},{},[29]);